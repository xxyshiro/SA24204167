<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="徐昕怡 SA24204167" />

<meta name="date" content="2024-12-09" />

<title>Homework</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Homework</h1>
<h4 class="author">徐昕怡 SA24204167</h4>
<h4 class="date">2024-12-09</h4>



<div id="example-1" class="section level1">
<h1>Example 1</h1>
<div id="question" class="section level2">
<h2>Question</h2>
<p>利用控制流语句输出九九乘法表如下：</p>
<p><img src="fig1.png" /></p>
</div>
<div id="solution" class="section level2">
<h2>Solution</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(n) { <span class="fu">cat</span>((<span class="dv">1</span><span class="sc">:</span>n)<span class="sc">*</span>n, <span class="at">sep =</span> <span class="st">&quot; &quot;</span>, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>) }</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>, f)</span></code></pre></div>
<pre><code>## 1 
## 2 4 
## 3 6 9 
## 4 8 12 16 
## 5 10 15 20 25 
## 6 12 18 24 30 36 
## 7 14 21 28 35 42 49 
## 8 16 24 32 40 48 56 64 
## 9 18 27 36 45 54 63 72 81</code></pre>
</div>
</div>
<div id="example-2" class="section level1">
<h1>Example 2</h1>
<div id="question-1" class="section level2">
<h2>Question</h2>
<p>设随机变量<span class="math inline">\(X, Y\)</span>服从如下分布：</p>
<p><span class="math display">\[
X\sim U(0, 1)~,~Y\sim I_{X\le p}*N(\mu_1, \sigma_1)+I_{X&gt;p}*N(\mu_2,
\sigma_2),
\]</span></p>
<p>其中<span class="math inline">\(U(0,1)\)</span>表示<span class="math inline">\((0,1)\)</span>上的均匀分布，<span class="math inline">\(0&lt;p&lt;1\)</span>，<span class="math inline">\(N(\mu, \sigma)\)</span>表示正态分布，<span class="math inline">\(I\)</span>为示性变量。给定两组参数值：</p>
<style>
.center {
width: auto;
display: table;
margin-left: auto;
margin-right: auto;
}
</style>
<div class="center">
<table>
<thead>
<tr class="header">
<th align="center"><span class="math inline">\(p\)</span></th>
<th align="center"><span class="math inline">\((\mu_1,\sigma_1)\)</span></th>
<th align="center"><span class="math inline">\((\mu_2,
\sigma_2)\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">0.5</td>
<td align="center">(0, 1)</td>
<td align="center">(3, 1)</td>
</tr>
<tr class="even">
<td align="center">0.7</td>
<td align="center">(0, 1)</td>
<td align="center">(3, 1)</td>
</tr>
</tbody>
</table>
</div>
<p>独立生成两组样本，每组样本量<span class="math inline">\(m=500\)</span>，绘制随机变量<span class="math inline">\(Y\)</span>的样本的直方图。</p>
</div>
<div id="solution-1" class="section level2">
<h2>Solution</h2>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">101</span>)</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>m <span class="ot">=</span> <span class="dv">500</span>; n <span class="ot">=</span> <span class="dv">1000</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> X[<span class="dv">1</span><span class="sc">:</span>m]; x2 <span class="ot">&lt;-</span> X[(m<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n]</span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a>n2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">3</span>, <span class="dv">1</span>)</span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> (x1<span class="sc">&lt;=</span>.<span class="dv">5</span>)<span class="sc">*</span>n1[<span class="dv">1</span><span class="sc">:</span>m] <span class="sc">+</span> (x1<span class="sc">&gt;</span>.<span class="dv">5</span>)<span class="sc">*</span>n2[<span class="dv">1</span><span class="sc">:</span>m]</span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a>y2 <span class="ot">&lt;-</span> (x2<span class="sc">&lt;=</span>.<span class="dv">7</span>)<span class="sc">*</span>n1[(m<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n] <span class="sc">+</span> (x2<span class="sc">&gt;</span>.<span class="dv">7</span>)<span class="sc">*</span>n2[(m<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n]</span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a></span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(y1, y2)))</span></code></pre></div>
<pre><code>##            y1          y2
## 1 -1.27235813  0.50319581
## 2 -0.66307158 -2.09747067
## 3  2.38577507 -0.09448458
## 4  3.56752086  1.01454241
## 5 -0.02617408  3.47402882
## 6  0.25972722  3.63742548</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">hist</span>(y1, <span class="at">main =</span> <span class="st">&quot;Sample of Y: Group 1&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;Y&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAq1BMVEUAAAAAADoAAGYAOjoAOmYAOpAAZpAAZrY6AAA6ADo6OgA6Ojo6OmY6ZpA6ZrY6kNtmAABmADpmOgBmOjpmkLZmkNtmtttmtv+QOgCQZgCQZjqQkGaQkLaQtpCQttuQ2/+2ZgC2Zjq2kGa227a229u22/+2/7a2/9u2///T09PbkDrbkGbbtmbbtpDb27bb29vb2//b/9vb////tmb/25D/27b//7b//9v///+cDKcqAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAJWUlEQVR4nO2daUPbNgCGFRpGRlfIetCs20p60HVuYRtOk/z/XzYdtuMj0msjn8r7fGgB63wiS7ItK2JPnIihCzB2KAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIEALgnYfL4WYvbhrEmUlzh/dIT4shLhSP62FuN4nP7wtB7t/JYR4dvVvg7yLrFFB/AXJympmldI744ByxSpJLWa7FLNb+f9mUYmTZt0o70ICH0T3gqKkkOLsa+04WFBkrCQZXOgo2V8OqTwh7xz3L0UPgtZidrPf/1iZE0Dn+cut/uAv7i/VsW8LMb/VAc8+yTNifpcJUh/g7CpXQHXGPHv9qE8nkQrZ6aRj06DyauWfZjfyl+8LfUw6/fOlOLvLJaPy/KrLcl3I3yDNz6rNsgNB+uOTZ8B1cmboqslCGS7TT3gtsoOmmkmQefbpJ41RHsoL0ifXfyuTTU7QoU1tnitPURr5kExJUJZ/mt38M2zKrZxis9efszL/9Ghcqdpf77/LAt2oIKaA8uP9rk4YU821+t2IzUQ8JoGj/Akl//Q86aFzglQbLRXk/G7/TyGZkqA0f8O3q0d8rrfWSc/fJxk9qEHtQhXKNJLzxFg6Cqky63KZYsuapB1I0hb1fwVBOouLcsY5tZoocZhPpiTo7eFwlnLngmQfcJmdKrt3phlfJJ+v+TcVpEumqq7LJf9aaPNpYbWbgiDd29yWs00ExYczS4cpJFPqg9L8szT6ESTzefh9kZw6Yv7Hw9IlSFborS5XLIqC0lNGBSgJkuErDSgNXxZUSMbkWck/n3DXgrKGrvI3v2ydgvItqDB9cbSgo4KSTrpGC6rkX8nTjrcgNY97I/O4X8j8zaeTdtIVQZU+qFhrax90XFA2zO8eXuYEHUkmFkP2QdlEUdZBDyBqSnS8BVVGMTlL+rHMimgdxXKC8jXKTRTVVUkapZiM/FcV6Ngo1pOgrJjyg8l+tgjKhTvMgw4mchOYOoJylxo3+1yUXDLZQFDMv1dB+50exczMVY1i8/dq5D7aB/0lD784zKR/vFuY31P0FPjNfl9TkJxTvFqkWeeiHJLZb+TM/sWnZSn/fMK9jGK1KJz8A/C0/CkIQEEACgLwliuAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQYAxCBKIQQs3ZOYJ4u8ild8HLdyQmSdQECAgQenK7XYXG4YjKEpf0IqLb2r5liEUQbtVpiUC69OblSEUQdtl9vpS3OZJFoygkbagbqdNDfugpAmNqg/qtsE1Sy1917vN9hOUoG44AUF+539AgtZCXOjJom0zkRMXFOkXTfWLhJZOOmBBlXeQq+hhPtbvPdqG+T4EVYb1vlpQJIR79NYTRTNFtE0UexHk1+CaFq7wm9vRWFrQgIKMIutlRNYH5ebU7uTqlWEygmI9Pu1W1nngKEaxoQSpWbIx43ElGrCg7bK6AY1Hco0iTULQgMnBGoNhvS9Ba3mC+V6mdyOo0eHOBK11B7RdoulizeSaRJqEoPR2od+9woAFpVObiIIsNTK3CzcLr04oZEFmMyLPsT5oQYMlR0Eo0jQEtfJYOWRB6zaeBQYsyHoX9WnJNYo0EUFP3NX7eHKNIk1C0G7lcY3R8WOfUQiS16ktNKGABWU7iHMU869Ry8lREIo0EUF6e/U1b5jZahTPbiO1yTOv5o/XSN0PUs+9eD/IUiM1UVSCeEfRUqO0Ba29Vo8FLCjpgyK/6WLIgsxUkXcU26hRy8lREIo0CUG8FqtXI/coD2/Lhi9ov3bcFsJv+5yAIEcTqvGuxgkIclxq1Hjbp17hmq5nGZMg1+qO1lpQ0xqPQlCd91Tw2z4BC6oFtHjqglpKbpKCsoniU+aKDR/7TFJQ8tinztX8ZmENE7Cg3crU2vE2ao1GNgpBJRr5sNdo+6u50eG61kgGr7G3oNKvNU2gGqUtyHlHcbs034t3ioLS13jAHbO1PH6igkwXA+9IywvWUxVUk83iGQU52a3sU4GgBfX36Hmagnp89DxJQX0+ep6koD4fPU9SUJ+PnicpqM9Hz9MU1OOj54kKaoOABVn3Cnhacu5QUxTU50r7SQpqZ2O7gAX1uXhhkoLagYJaSW56gnx76HE99ulKUBsDPQXVSg6GoiAQioJAKAoCoSgIhJqgII+lHdXkYKjJCWoNCmolOQpCoSgIhKIgEIqCQCgKAqEoCISiIBCKgkCoXgX5rXo9AUHlw13UKKWlNw6DFdTWG4ehCqr9vljltHe/QReMIPsbh6UeEAoalO4EdfX9YqOmYR/UyfeLjZpmDa6b7xcbNS3Pg8KjE0HDdsKIMQjyO+532De6X/B2EqUgv+MUREF+xymIgvyOUxAF+R0PX1BIUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIEBXglxbgOhFNLZHs7Fz9wdn1BpZq69KbfY9ah0Jih0PX3craSCylFNtNRdbDTmj1sg6locafpt1N4L0Zla2g2aPuOP7FJn1EdZd0V1Ra2RtUm+2Q1I3gqLz39Dj++PNpIYBW9QaWW9+br51SyeCZEHgNkTHv7XUVAFsAuH6wlNn1vHZlyXswkp0IUi1ZCTIsoDGNA5nE3GuvXFnHanFlQ2/7bILQTU2soodfTQQZItaI2uzzWizTUo6EKRPE7cgayPAp5hz7RbI2vRtjo1Ej9CuoEjNUqJkmcmRYkRmFhNZKwk7aXvUNH1L1gojvllXPcRE0bFPGhjma+0Hbs/arEId/BTTOARtFo5G4J4oOqPWyFp1UQ1f7h5AUHIeWCxErksNd1SctbqQGcEwHxQUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgwLgFbZfJip5mS3fbZNyCkuVSft/c6cfIBekFm57f/erH2AWpFUFDNqDRC5JN6MuQDWj8gjaLYbeUG72gWssSO2T8gtyryjuHggAUBKAgAAUBxi9oYCgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIMD/wvNyhVJNgdkAAAAASUVORK5CYII=" /><!-- --></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="fu">hist</span>(y2, <span class="at">main =</span> <span class="st">&quot;Sample of Y: Group 2&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;Y&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="example-3" class="section level1">
<h1>Example 3</h1>
<div id="question-2" class="section level2">
<h2>Question</h2>
<p>生成200个服从多元正态的随机变量的独立样本，其中多元正态分布的各分量均值为0，给定协方差矩阵如下：
<span class="math display">\[
\Sigma =
\begin{bmatrix}
1 &amp; -0.5 &amp; 0.5 \\
-0.5 &amp; 1 &amp; -0.5 \\
0.5 &amp; -0.5 &amp; 1\\
\end{bmatrix}
\]</span></p>
<p>按照两两分量绘制散点图，观察各分量之间的相关性。</p>
</div>
<div id="solution-2" class="section level2">
<h2>Solution</h2>
<p>第一步生成样本：</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">200</span></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fu">diag</span>(<span class="dv">3</span>)</span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a>sigma[<span class="dv">2</span>, <span class="dv">1</span>] <span class="ot">&lt;-</span> sigma[<span class="dv">1</span>, <span class="dv">2</span>] <span class="ot">&lt;-</span> sigma[<span class="dv">3</span>, <span class="dv">2</span>] <span class="ot">&lt;-</span> sigma[<span class="dv">2</span>, <span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="sc">-</span>.<span class="dv">5</span></span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a>sigma[<span class="dv">1</span>, <span class="dv">3</span>] <span class="ot">&lt;-</span> sigma[<span class="dv">3</span>, <span class="dv">1</span>] <span class="ot">&lt;-</span> .<span class="dv">5</span> <span class="do">## 生成协方差矩阵</span></span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a></span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(n, <span class="at">mu =</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">3</span>), <span class="at">Sigma =</span> sigma)</span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a></span>
<span id="cb7-13"><a href="#cb7-13" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">as.data.frame</span>(x))</span></code></pre></div>
<pre><code>##            V1         V2         V3
## 1 -0.50009404  1.5357978  0.6630125
## 2 -0.86266035  0.5067850  0.8056280
## 3  0.90620793 -1.5884886  1.3233435
## 4  0.04091818  0.2057013  0.3374927
## 5  0.49278949 -0.1191197 -0.2952202
## 6  0.44740121 -2.1149399  1.6386930</code></pre>
<p>第二步绘制相关性散点图（并在对角线上画出各分量的密度）：</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="fu">pairs</span>(x)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="exercise-3.4" class="section level2">
<h2>Exercise 3.4</h2>
<p>The Rayleigh density is</p>
<p><span class="math display">\[
f(x) = \frac{x}{\sigma^2}exp(-\frac{x^2}{2\sigma^2}),~x\ge0,\sigma&gt;0.
\]</span></p>
<div id="question-1-1" class="section level4">
<h4>Question 1</h4>
<p>Develop an algorithm to generate i.i.d. samples from a Rayleigh(<span class="math inline">\(\sigma\)</span>) distribution.</p>
</div>
<div id="solution-3" class="section level4">
<h4>Solution</h4>
<p>We can easily calculate the distribution function of <span class="math inline">\(X\sim\)</span> Rayleigh(<span class="math inline">\(\sigma\)</span>), which is given by</p>
<p><span class="math display">\[
F(x)=1 - exp(-\frac{x^2}{2\sigma^2}),~x\ge0,\sigma&gt;0.
\]</span></p>
<p>Due to the fact that <span class="math inline">\(U = F(X)\sim U(0,
1)\)</span>, we write</p>
<p><span class="math display">\[
X = F^{-1}(U) = \sigma\sqrt{2log(\frac{1}{1-U})}.
\]</span></p>
<p>We develop an algorithm with following steps:</p>
<p>1.Sampling from <span class="math inline">\(U(0, 1)\)</span>, name
them <span class="math inline">\(u_1, \dots, u_n\)</span>;</p>
<p>2.Get samples we wanted by <span class="math inline">\(x_i =
F^{-1}(u_i)\)</span>.</p>
<p>By doing so we get the samples generated from a Rayleigh(<span class="math inline">\(\sigma\)</span>) distribution.</p>
<p>The R function <code>gen.Rayleigh</code> we develop that generates
Rayleigh(<span class="math inline">\(\sigma\)</span>) samples of size
<span class="math inline">\(n\)</span> is defined by:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>gen.Rayleigh <span class="ot">&lt;-</span> <span class="cf">function</span>(n, <span class="at">sigma =</span> <span class="dv">1</span>){</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>  u <span class="ot">=</span> <span class="fu">runif</span>(n)</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>  x <span class="ot">=</span> sigma<span class="sc">*</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>u)))</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>  <span class="fu">return</span>(x)</span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="question-2-1" class="section level4">
<h4>Question 2</h4>
<p>Experimenting with several choices of <span class="math inline">\(\sigma&gt;0\)</span>, histogram each group of
samples and see whether their modes are close to their own <span class="math inline">\(\sigma\)</span>.</p>
</div>
<div id="solution-4" class="section level4">
<h4>Solution</h4>
<p>Let <span class="math inline">\(\sigma = 1, 5, 10\)</span>, generate
three groups of Rayleigh samples of size <span class="math inline">\(1000\)</span>:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="do">## Generate Rayleigh sample with different sigma</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">124</span>)</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">1000</span></span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>sigma.all <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">10</span>)</span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="dv">3</span>, n))</span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a></span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>){</span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a>  sigma <span class="ot">=</span> sigma.all[i]</span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a>  x[i, ] <span class="ot">&lt;-</span> <span class="fu">gen.Rayleigh</span>(n, sigma)</span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a>}</span></code></pre></div>
<p>Plotting histograms by group using package <code>ggplot2</code>:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="do">## library</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="do">## Build a dataset containing all samples, with their groups labeled</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>data <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Group =</span> <span class="fu">factor</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>, n), <span class="fu">rep</span>(<span class="dv">2</span>, n), <span class="fu">rep</span>(<span class="dv">3</span>, n)),</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>                                 <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>),</span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a>                                 <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Rayleigh(1)&quot;</span>, <span class="st">&quot;Rayleigh(5)&quot;</span>, <span class="st">&quot;Rayleigh(10)&quot;</span>)),</span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a>                  <span class="at">value =</span> <span class="fu">c</span>(x[<span class="dv">1</span>, ], x[<span class="dv">2</span>, ], x[<span class="dv">3</span>, ]))</span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a><span class="do">## Represent it</span></span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a>p <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>value, <span class="at">fill=</span>Group)) <span class="sc">+</span></span>
<span id="cb13-10"><a href="#cb13-10" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">color=</span><span class="st">&quot;#e9ecef&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">position =</span> <span class="st">&quot;identity&quot;</span>,</span>
<span id="cb13-11"><a href="#cb13-11" tabindex="-1"></a>                   <span class="at">binwidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb13-12"><a href="#cb13-12" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>),</span>
<span id="cb13-13"><a href="#cb13-13" tabindex="-1"></a>                       <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">30</span>)) <span class="sc">+</span></span>
<span id="cb13-14"><a href="#cb13-14" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;#f7ea83&quot;</span>, <span class="st">&quot;#69b3a2&quot;</span>, <span class="st">&quot;#404080&quot;</span>)) <span class="sc">+</span></span>
<span id="cb13-15"><a href="#cb13-15" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">10</span>), <span class="at">color =</span> <span class="st">&quot;#e05c5c&quot;</span>, <span class="at">size =</span> .<span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb13-16"><a href="#cb13-16" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">caption =</span> <span class="st">&quot;choose binwidth = 1&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
## ℹ Please use `linewidth` instead.
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was
## generated.</code></pre>
<pre><code>## Warning: Removed 12 rows containing non-finite outside the scale range
## (`stat_bin()`).</code></pre>
<pre><code>## Warning: Removed 6 rows containing missing values or values outside the scale range
## (`geom_bar()`).</code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Note that I have marked <span class="math inline">\(\sigma = (1, 5,
10)\)</span> with <span style="color:red">vertical lines</span> in this
plot.</p>
<p>It is significant enough that within all the three groups, the
neighborhood of the <span class="math inline">\(\sigma\)</span>s are of
highest frequency, while this significance mildly declines as <span class="math inline">\(\sigma\)</span> grows large.</p>
</div>
</div>
<div id="exercise-3.11" class="section level2">
<h2>Exercise 3.11</h2>
<div id="question-1-2" class="section level4">
<h4>Question 1</h4>
<p>Generate a random sample of size <span class="math inline">\(1000\)</span> from a normal location mixture. The
components of the mixture have <span class="math inline">\(N(0,
1)\)</span> and <span class="math inline">\(N(3,1)\)</span>
distributions with mixing probabilities <span class="math inline">\(p_1\)</span> and <span class="math inline">\(p_2 =
1- p_1\)</span>. Graph the histogram of the sample with density
superimposed, for <span class="math inline">\(p_1=0.75\)</span>.</p>
</div>
<div id="solution-5" class="section level4">
<h4>Solution</h4>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="do">## function to generate samples</span></span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a>gen_mix2 <span class="ot">&lt;-</span> <span class="cf">function</span>(p1, <span class="at">n =</span> <span class="dv">1000</span>, <span class="at">mu =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">3</span>)){</span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a>  x1 <span class="ot">=</span> <span class="fu">rnorm</span>(n, mu[<span class="dv">1</span>])</span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a>  x2 <span class="ot">=</span> <span class="fu">rnorm</span>(n, mu[<span class="dv">2</span>])</span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a></span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a>  u <span class="ot">=</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>), <span class="at">size =</span> n, <span class="at">prob =</span> <span class="fu">c</span>(p1, <span class="dv">1</span><span class="sc">-</span>p1), <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb17-8"><a href="#cb17-8" tabindex="-1"></a></span>
<span id="cb17-9"><a href="#cb17-9" tabindex="-1"></a>  <span class="fu">return</span>(u<span class="sc">*</span>x1 <span class="sc">+</span> (<span class="dv">1</span><span class="sc">-</span>u)<span class="sc">*</span>x2)</span>
<span id="cb17-10"><a href="#cb17-10" tabindex="-1"></a>}</span>
<span id="cb17-11"><a href="#cb17-11" tabindex="-1"></a></span>
<span id="cb17-12"><a href="#cb17-12" tabindex="-1"></a><span class="do">## generate samples with p1 = 0.75</span></span>
<span id="cb17-13"><a href="#cb17-13" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb17-14"><a href="#cb17-14" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">gen_mix2</span>(.<span class="dv">75</span>)</span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="do">## Histogram it</span></span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a>data <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x)</span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a>p <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> </span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x)) <span class="sc">+</span> </span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> ..density..),<span class="at">color =</span> <span class="st">&quot;#e9ecef&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>, </span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a>                 <span class="at">binwidth =</span> <span class="fl">0.15</span>) <span class="sc">+</span> </span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">color =</span> <span class="st">&quot;#69b3a2&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb18-9"><a href="#cb18-9" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;p1 = 0.75&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: The dot-dot notation (`..density..`) was deprecated in ggplot2 3.4.0.
## ℹ Please use `after_stat(density)` instead.
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was
## generated.</code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="question-2-2" class="section level4">
<h4>Question 2</h4>
<p>Repeat with different values for <span class="math inline">\(p_1\)</span> and observe whether the empirical
distribution of the mixture appears to be bimodal. Make a conjecture
about the values of p1 that produce bimodal mixtures.</p>
</div>
<div id="solution-6" class="section level4">
<h4>Solution</h4>
<p>Try different values of <span class="math inline">\(p_1\)</span>s.
Due to the symmetry of the problem setting, here we only let <span class="math inline">\(p1 = (0.5, 0.6, 0.7, 0.8, 0.9)\)</span>.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="do">## Generate samples with different p1s</span></span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">1000</span></span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a>p1 <span class="ot">=</span> <span class="dv">5</span><span class="sc">:</span><span class="dv">9</span> <span class="sc">/</span> <span class="dv">10</span></span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="dv">5</span>, n))</span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>){</span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a>  x[i, ] <span class="ot">=</span> <span class="fu">gen_mix2</span>(p1[i])</span>
<span id="cb20-7"><a href="#cb20-7" tabindex="-1"></a>}</span>
<span id="cb20-8"><a href="#cb20-8" tabindex="-1"></a><span class="do">## Build dataset</span></span>
<span id="cb20-9"><a href="#cb20-9" tabindex="-1"></a>dat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">value =</span> <span class="fu">c</span>(x[<span class="dv">1</span>, ], x[<span class="dv">2</span>, ], x[<span class="dv">3</span>, ], x[<span class="dv">4</span>, ], x[<span class="dv">5</span>, ]),</span>
<span id="cb20-10"><a href="#cb20-10" tabindex="-1"></a>                 <span class="at">p1 =</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="fu">rep</span>(p1[<span class="dv">1</span>], n), <span class="fu">rep</span>(p1[<span class="dv">2</span>], n),</span>
<span id="cb20-11"><a href="#cb20-11" tabindex="-1"></a>                                       <span class="fu">rep</span>(p1[<span class="dv">3</span>], n), <span class="fu">rep</span>(p1[<span class="dv">4</span>], n),</span>
<span id="cb20-12"><a href="#cb20-12" tabindex="-1"></a>                                       <span class="fu">rep</span>(p1[<span class="dv">5</span>], n))))</span></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a><span class="do">## Plot them</span></span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dat) <span class="sc">+</span></span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">fill =</span> p1), <span class="at">color =</span> <span class="cn">NA</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="at">rows =</span> <span class="fu">vars</span>(p1))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>From these five plots I shall form the conjecture that <span class="math inline">\(p_1\)</span> that satisfies <span class="math inline">\(0.2\le p_1\le0.8\)</span> would well produce
bimodal mixtures.</p>
</div>
</div>
<div id="exercise-3.20" class="section level2">
<h2>Exercise 3.20</h2>
<p>A <em>compound Poisson process</em> is a stochastic process <span class="math inline">\(\{X(t), t\ge 0\}\)</span> that can be represented
as the random sum <span class="math inline">\(X(t) = \sum_{i =
1}^{N(t)}Y_i\)</span>, <span class="math inline">\(t\ge 0\)</span>,
where <span class="math inline">\(\{N(t), t \ge 0 \}\)</span> is a
Poisson process and <span class="math inline">\(Y_1, Y_2,\dots\)</span>
are i.i.d. and independent of <span class="math inline">\(\{N(t), t\ge
0\}\)</span>.</p>
<div id="question-1-3" class="section level4">
<h4>Question 1</h4>
<p>Write a program to simulate a compound Poisson(<span class="math inline">\(\lambda\)</span>)-Gamma process.</p>
</div>
<div id="solution-7" class="section level4">
<h4>Solution</h4>
<p>A Poisson(<span class="math inline">\(\lambda\)</span>) process <span class="math inline">\(\{N(t), t \ge 0 \}\)</span> can be interpreted as
an counting process, which yields</p>
<p><span class="math display">\[
N(t + \tau) - N(t)\sim Poisson(\lambda \tau),~ t\ge 0, ~\tau\ge 0.
\]</span></p>
<p>Let the rate parameter <span class="math inline">\(\lambda =
2\)</span>, we simulate a <span class="math inline">\(Poi(\lambda =
1)\)</span> process:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a><span class="do">## generate time nodes</span></span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a>tau <span class="ot">=</span> <span class="fl">0.025</span>; m <span class="ot">=</span> <span class="dv">500</span></span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a>t <span class="ot">=</span> <span class="fu">cumsum</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">rep</span>(tau, m)))</span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a></span>
<span id="cb22-5"><a href="#cb22-5" tabindex="-1"></a><span class="do">## generate increments of Nt between time nodes</span></span>
<span id="cb22-6"><a href="#cb22-6" tabindex="-1"></a>lambda <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb22-7"><a href="#cb22-7" tabindex="-1"></a>h <span class="ot">=</span> <span class="fu">rpois</span>(m, lambda<span class="sc">*</span>tau)</span>
<span id="cb22-8"><a href="#cb22-8" tabindex="-1"></a></span>
<span id="cb22-9"><a href="#cb22-9" tabindex="-1"></a><span class="do">## generate Nt</span></span>
<span id="cb22-10"><a href="#cb22-10" tabindex="-1"></a>Nt <span class="ot">=</span> <span class="fu">cumsum</span>(<span class="fu">c</span>(<span class="dv">0</span>, h))</span>
<span id="cb22-11"><a href="#cb22-11" tabindex="-1"></a></span>
<span id="cb22-12"><a href="#cb22-12" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> t, <span class="at">y =</span> Nt, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>,</span>
<span id="cb22-13"><a href="#cb22-13" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Simulation of Poi(1)&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;N(t)&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>And then we impose <span class="math inline">\(Y_i\)</span> i.i.d.
<span class="math inline">\(\sim \Gamma(\alpha=2, \beta=2)\)</span> into
the model,</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a>alpha <span class="ot">=</span> <span class="dv">2</span>; beta <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a>n <span class="ot">=</span> <span class="fu">max</span>(Nt)</span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a>y <span class="ot">=</span> <span class="fu">rgamma</span>(n, alpha, beta)</span></code></pre></div>
<p>and we get:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a>y_cumsum <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">cumsum</span>(y))</span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a>Xt <span class="ot">=</span> <span class="cn">NULL</span></span>
<span id="cb24-3"><a href="#cb24-3" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span>m){</span>
<span id="cb24-4"><a href="#cb24-4" tabindex="-1"></a>  Xt <span class="ot">&lt;-</span> <span class="fu">c</span>(Xt, y_cumsum[Nt[i<span class="sc">+</span><span class="dv">1</span>] <span class="sc">+</span> <span class="dv">1</span>])</span>
<span id="cb24-5"><a href="#cb24-5" tabindex="-1"></a>}</span>
<span id="cb24-6"><a href="#cb24-6" tabindex="-1"></a></span>
<span id="cb24-7"><a href="#cb24-7" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> t, <span class="at">y =</span> Xt, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>,</span>
<span id="cb24-8"><a href="#cb24-8" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Simulation of Compound Poi(1)-Gamma(2, 2) process&quot;</span>,</span>
<span id="cb24-9"><a href="#cb24-9" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;X(t)&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="question-2-3" class="section level4">
<h4>Question 2</h4>
<p>Estimate the mean and the variance of <span class="math inline">\(X(10)\)</span> for several choices of the
parameters and compare with the theoretical values.</p>
</div>
<div id="solution-8" class="section level4">
<h4>Solution</h4>
<p>Theoretically, mean <span class="math display">\[
E[X(t)] = \lambda t E[Y_1] = (\lambda t)\frac{\alpha}{\beta},
\]</span> and variance</p>
<p><span class="math display">\[
Var[X(t)] = \lambda t E[Y_1^2]=\lambda t (Var[Y_1]+E[Y_1]^2) = \lambda t
\frac{\alpha(1+\alpha)}{\beta^2}
\]</span></p>
<p>Rewrite the solution to the former question into a function:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a>gen_Xt <span class="ot">&lt;-</span> <span class="cf">function</span>(lambda, alpha, beta){</span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a>  <span class="do">## generate time nodes</span></span>
<span id="cb25-3"><a href="#cb25-3" tabindex="-1"></a>  tau <span class="ot">=</span> <span class="fl">0.025</span>; m <span class="ot">=</span> <span class="dv">500</span></span>
<span id="cb25-4"><a href="#cb25-4" tabindex="-1"></a>  t <span class="ot">=</span> <span class="fu">cumsum</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">rep</span>(tau, m)))</span>
<span id="cb25-5"><a href="#cb25-5" tabindex="-1"></a></span>
<span id="cb25-6"><a href="#cb25-6" tabindex="-1"></a>  <span class="do">## generate increments of Nt between time nodes</span></span>
<span id="cb25-7"><a href="#cb25-7" tabindex="-1"></a>  h <span class="ot">=</span> <span class="fu">rpois</span>(m, lambda<span class="sc">*</span>tau)</span>
<span id="cb25-8"><a href="#cb25-8" tabindex="-1"></a></span>
<span id="cb25-9"><a href="#cb25-9" tabindex="-1"></a>  <span class="do">## generate Nt</span></span>
<span id="cb25-10"><a href="#cb25-10" tabindex="-1"></a>  Nt <span class="ot">=</span> <span class="fu">cumsum</span>(<span class="fu">c</span>(<span class="dv">0</span>, h))</span>
<span id="cb25-11"><a href="#cb25-11" tabindex="-1"></a>  </span>
<span id="cb25-12"><a href="#cb25-12" tabindex="-1"></a>  <span class="do">## generate Gamma r.v.s</span></span>
<span id="cb25-13"><a href="#cb25-13" tabindex="-1"></a>  n <span class="ot">=</span> <span class="fu">max</span>(Nt)</span>
<span id="cb25-14"><a href="#cb25-14" tabindex="-1"></a>  y <span class="ot">=</span> <span class="fu">rgamma</span>(n, alpha, beta)</span>
<span id="cb25-15"><a href="#cb25-15" tabindex="-1"></a>  </span>
<span id="cb25-16"><a href="#cb25-16" tabindex="-1"></a>  <span class="do">## generate Xt</span></span>
<span id="cb25-17"><a href="#cb25-17" tabindex="-1"></a>  y_cumsum <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">cumsum</span>(y))</span>
<span id="cb25-18"><a href="#cb25-18" tabindex="-1"></a>  Xt <span class="ot">=</span> <span class="cn">NULL</span></span>
<span id="cb25-19"><a href="#cb25-19" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span>m){</span>
<span id="cb25-20"><a href="#cb25-20" tabindex="-1"></a>    Xt <span class="ot">&lt;-</span> <span class="fu">c</span>(Xt, y_cumsum[Nt[i<span class="sc">+</span><span class="dv">1</span>] <span class="sc">+</span> <span class="dv">1</span>])</span>
<span id="cb25-21"><a href="#cb25-21" tabindex="-1"></a>  }</span>
<span id="cb25-22"><a href="#cb25-22" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">data.frame</span>(<span class="at">t =</span> t, <span class="at">Xt =</span> Xt))</span>
<span id="cb25-23"><a href="#cb25-23" tabindex="-1"></a>}</span></code></pre></div>
<p>Here lists the parameters we choose, and the functions to calculate
theoretical means and variances:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a>lambda <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a>alpha <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb26-3"><a href="#cb26-3" tabindex="-1"></a>beta <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>)</span>
<span id="cb26-4"><a href="#cb26-4" tabindex="-1"></a></span>
<span id="cb26-5"><a href="#cb26-5" tabindex="-1"></a>mean_theo <span class="ot">&lt;-</span> <span class="cf">function</span>(l, a, b, <span class="at">t =</span> <span class="dv">10</span>){</span>
<span id="cb26-6"><a href="#cb26-6" tabindex="-1"></a>  l<span class="sc">*</span>t<span class="sc">*</span>a<span class="sc">/</span>b</span>
<span id="cb26-7"><a href="#cb26-7" tabindex="-1"></a>}</span>
<span id="cb26-8"><a href="#cb26-8" tabindex="-1"></a></span>
<span id="cb26-9"><a href="#cb26-9" tabindex="-1"></a>var_theo <span class="ot">&lt;-</span> <span class="cf">function</span>(l, a, b, <span class="at">t =</span> <span class="dv">10</span>){</span>
<span id="cb26-10"><a href="#cb26-10" tabindex="-1"></a>  l<span class="sc">*</span>t<span class="sc">*</span>a<span class="sc">*</span>(<span class="dv">1</span> <span class="sc">+</span> a)<span class="sc">/</span>b<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb26-11"><a href="#cb26-11" tabindex="-1"></a>}</span></code></pre></div>
<p>Obtain empirical means and variances through Monte-Carlo, we finally
get:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a>R <span class="ot">=</span> <span class="dv">200</span> <span class="do">## number of reputations</span></span>
<span id="cb27-2"><a href="#cb27-2" tabindex="-1"></a>mean_all <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb27-3"><a href="#cb27-3" tabindex="-1"></a>var_all <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb27-4"><a href="#cb27-4" tabindex="-1"></a>mean_th <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb27-5"><a href="#cb27-5" tabindex="-1"></a>var_th <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb27-6"><a href="#cb27-6" tabindex="-1"></a></span>
<span id="cb27-7"><a href="#cb27-7" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>){ <span class="do">## the i-th coupling of parameters</span></span>
<span id="cb27-8"><a href="#cb27-8" tabindex="-1"></a>  X10 <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb27-9"><a href="#cb27-9" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>R){</span>
<span id="cb27-10"><a href="#cb27-10" tabindex="-1"></a>    X <span class="ot">&lt;-</span> <span class="fu">gen_Xt</span>(lambda[j], alpha[j], beta[j])</span>
<span id="cb27-11"><a href="#cb27-11" tabindex="-1"></a>    X10 <span class="ot">&lt;-</span> <span class="fu">c</span>(X10, X[t <span class="sc">==</span> <span class="dv">10</span>, <span class="st">&quot;Xt&quot;</span>])</span>
<span id="cb27-12"><a href="#cb27-12" tabindex="-1"></a>  }</span>
<span id="cb27-13"><a href="#cb27-13" tabindex="-1"></a>  </span>
<span id="cb27-14"><a href="#cb27-14" tabindex="-1"></a>  mean_all <span class="ot">&lt;-</span> <span class="fu">c</span>(mean_all, <span class="fu">mean</span>(X10)) <span class="do">## sample mean of X(10)</span></span>
<span id="cb27-15"><a href="#cb27-15" tabindex="-1"></a>  var_all <span class="ot">&lt;-</span> <span class="fu">c</span>(var_all, <span class="fu">var</span>(X10)) <span class="do">## sample variance of X(10)</span></span>
<span id="cb27-16"><a href="#cb27-16" tabindex="-1"></a>  </span>
<span id="cb27-17"><a href="#cb27-17" tabindex="-1"></a>  <span class="do">## theoretical values</span></span>
<span id="cb27-18"><a href="#cb27-18" tabindex="-1"></a>  mean_th <span class="ot">&lt;-</span> <span class="fu">c</span>(mean_th, <span class="fu">mean_theo</span>(lambda[j], alpha[j], beta[j]))</span>
<span id="cb27-19"><a href="#cb27-19" tabindex="-1"></a>  var_th <span class="ot">&lt;-</span> <span class="fu">c</span>(var_th, <span class="fu">var_theo</span>(lambda[j], alpha[j], beta[j]))</span>
<span id="cb27-20"><a href="#cb27-20" tabindex="-1"></a>}</span>
<span id="cb27-21"><a href="#cb27-21" tabindex="-1"></a></span>
<span id="cb27-22"><a href="#cb27-22" tabindex="-1"></a>result <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">lambda =</span> lambda, <span class="at">alpha =</span> alpha, <span class="at">beta =</span> beta, </span>
<span id="cb27-23"><a href="#cb27-23" tabindex="-1"></a>                    <span class="at">emp_mean =</span> mean_all, <span class="at">theo_mean =</span> mean_th,</span>
<span id="cb27-24"><a href="#cb27-24" tabindex="-1"></a>                    <span class="at">emp_variance =</span> var_all, <span class="at">theo_variance =</span> var_th)</span>
<span id="cb27-25"><a href="#cb27-25" tabindex="-1"></a></span>
<span id="cb27-26"><a href="#cb27-26" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(result, <span class="at">align =</span> <span class="fu">c</span>(<span class="st">&quot;l&quot;</span>, <span class="st">&quot;l&quot;</span>, <span class="st">&quot;l&quot;</span>, <span class="st">&quot;l&quot;</span>, <span class="st">&quot;l&quot;</span>, <span class="st">&quot;l&quot;</span>, <span class="st">&quot;l&quot;</span>))</span></code></pre></div>
<table>
<colgroup>
<col width="10%" />
<col width="9%" />
<col width="7%" />
<col width="15%" />
<col width="15%" />
<col width="20%" />
<col width="21%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">lambda</th>
<th align="left">alpha</th>
<th align="left">beta</th>
<th align="left">emp_mean</th>
<th align="left">theo_mean</th>
<th align="left">emp_variance</th>
<th align="left">theo_variance</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">1</td>
<td align="left">1</td>
<td align="left">1</td>
<td align="left">9.958509</td>
<td align="left">10</td>
<td align="left">16.59114</td>
<td align="left">20</td>
</tr>
<tr class="even">
<td align="left">2</td>
<td align="left">2</td>
<td align="left">2</td>
<td align="left">20.279075</td>
<td align="left">20</td>
<td align="left">31.91771</td>
<td align="left">30</td>
</tr>
<tr class="odd">
<td align="left">2</td>
<td align="left">3</td>
<td align="left">1</td>
<td align="left">61.131492</td>
<td align="left">60</td>
<td align="left">270.93760</td>
<td align="left">240</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="quick-sort-algorithm" class="section level2">
<h2>Quick Sort Algorithm</h2>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a><span class="do">## Quick sort algorithm</span></span>
<span id="cb28-2"><a href="#cb28-2" tabindex="-1"></a>qs <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb28-3"><a href="#cb28-3" tabindex="-1"></a>  n <span class="ot">=</span> <span class="fu">length</span>(x)</span>
<span id="cb28-4"><a href="#cb28-4" tabindex="-1"></a>  <span class="cf">if</span> (n <span class="sc">==</span> <span class="dv">0</span> <span class="sc">||</span> n <span class="sc">==</span> <span class="dv">1</span>){</span>
<span id="cb28-5"><a href="#cb28-5" tabindex="-1"></a>    <span class="fu">return</span>(x)</span>
<span id="cb28-6"><a href="#cb28-6" tabindex="-1"></a>  }</span>
<span id="cb28-7"><a href="#cb28-7" tabindex="-1"></a>  </span>
<span id="cb28-8"><a href="#cb28-8" tabindex="-1"></a>  a <span class="ot">=</span> x[<span class="dv">1</span>]</span>
<span id="cb28-9"><a href="#cb28-9" tabindex="-1"></a>  y <span class="ot">=</span> x[<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb28-10"><a href="#cb28-10" tabindex="-1"></a>  lower <span class="ot">=</span> y[y <span class="sc">&lt;</span> a]</span>
<span id="cb28-11"><a href="#cb28-11" tabindex="-1"></a>  upper <span class="ot">=</span> y[y <span class="sc">&gt;=</span> a]</span>
<span id="cb28-12"><a href="#cb28-12" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">c</span>(<span class="fu">qs</span>(lower), a, <span class="fu">qs</span>(upper)))</span>
<span id="cb28-13"><a href="#cb28-13" tabindex="-1"></a>}</span></code></pre></div>
<div id="requirements" class="section level4">
<h4>Requirements</h4>
<p>For <span class="math inline">\(n = 10^4, 2\times 10^4, 4\times 10^4,
6\times 10^4, 8\times 10^4\)</span>, apply the quick sort on random
permutations of <span class="math inline">\((1, 2, \dots, n)\)</span>,
each done with <span class="math inline">\(100\)</span> repetitions,
calculate for each <span class="math inline">\(n\)</span>, the average
computation time, denoted by <span class="math inline">\(a_n\)</span>.</p>
<p>Regress <span class="math inline">\(a_n\)</span> on <span class="math inline">\(t_n := n\mathrm{log}(n)\)</span>, and graph the
result. (Scatter plot and regression line suggested.)</p>
</div>
<div id="experiment" class="section level4">
<h4>Experiment</h4>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a>n.all <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">8</span>)<span class="sc">*</span><span class="fl">1e4</span></span>
<span id="cb29-2"><a href="#cb29-2" tabindex="-1"></a>an <span class="ot">=</span> <span class="cn">NULL</span></span>
<span id="cb29-3"><a href="#cb29-3" tabindex="-1"></a>m <span class="ot">=</span> <span class="dv">100</span> <span class="do">## repetitions</span></span>
<span id="cb29-4"><a href="#cb29-4" tabindex="-1"></a></span>
<span id="cb29-5"><a href="#cb29-5" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>){</span>
<span id="cb29-6"><a href="#cb29-6" tabindex="-1"></a>  n <span class="ot">=</span> n.all[i]</span>
<span id="cb29-7"><a href="#cb29-7" tabindex="-1"></a>  am <span class="ot">=</span> <span class="fu">rep</span>(<span class="cn">NA</span>, m)</span>
<span id="cb29-8"><a href="#cb29-8" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){ <span class="do">## Monte Carlo simulations</span></span>
<span id="cb29-9"><a href="#cb29-9" tabindex="-1"></a>    x <span class="ot">=</span> <span class="fu">sample</span>(n) <span class="do">## a permutation of 1:n</span></span>
<span id="cb29-10"><a href="#cb29-10" tabindex="-1"></a>    am[j] <span class="ot">=</span> <span class="fu">system.time</span>(<span class="fu">qs</span>(x))[<span class="dv">1</span>]</span>
<span id="cb29-11"><a href="#cb29-11" tabindex="-1"></a>  }</span>
<span id="cb29-12"><a href="#cb29-12" tabindex="-1"></a>  an <span class="ot">=</span> <span class="fu">c</span>(an, <span class="fu">mean</span>(am))</span>
<span id="cb29-13"><a href="#cb29-13" tabindex="-1"></a>}</span></code></pre></div>
<p>And results are:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a>tn <span class="ot">=</span> n.all<span class="sc">*</span><span class="fu">log</span>(n.all)</span>
<span id="cb30-2"><a href="#cb30-2" tabindex="-1"></a>data <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">an =</span> an, <span class="at">tn =</span> tn)</span>
<span id="cb30-3"><a href="#cb30-3" tabindex="-1"></a></span>
<span id="cb30-4"><a href="#cb30-4" tabindex="-1"></a><span class="fu">plot</span>(tn, an)</span>
<span id="cb30-5"><a href="#cb30-5" tabindex="-1"></a></span>
<span id="cb30-6"><a href="#cb30-6" tabindex="-1"></a>fit <span class="ot">=</span> <span class="fu">lm</span>(an<span class="sc">~</span>tn, <span class="at">data =</span> data)</span>
<span id="cb30-7"><a href="#cb30-7" tabindex="-1"></a><span class="fu">abline</span>(fit, <span class="at">col =</span> <span class="st">&quot;#3db30e&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="beta-distribution-monte-carlo" class="section level2">
<h2>Beta distribution Monte Carlo</h2>
<div id="question-3" class="section level4">
<h4>Question</h4>
<p>Write a function estimating the <span class="math inline">\(\mathrm{Beta}(3, 3)\)</span> cdf. Give Monte Carlo
estimated values of <span class="math inline">\(F(x), x= 0.1,\dots,
0.9\)</span> and compare them with real ones.</p>
</div>
<div id="solution-9" class="section level4">
<h4>Solution</h4>
<p>The <span class="math inline">\(k\)</span>th order statistic of <span class="math inline">\(n\)</span> i.i.d. <span class="math inline">\(\mathrm{U}(0, 1)\)</span> random variables is
<span class="math inline">\(\mathrm{Beta}(k, m+1-k)\)</span>. Let
<code>m = 5</code>, <code>k = 3</code>, we write a function generating
the order statistic, and estimate <span class="math inline">\(\mathrm{Beta}(3,3)\)</span> by empirical
distribution.</p>
<p>First we prepare with the functions:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a><span class="do">## order statistic generator</span></span>
<span id="cb31-2"><a href="#cb31-2" tabindex="-1"></a>kth.gen <span class="ot">&lt;-</span> <span class="cf">function</span>(n, <span class="at">k =</span> <span class="dv">3</span>, <span class="at">m =</span> <span class="dv">5</span>){</span>
<span id="cb31-3"><a href="#cb31-3" tabindex="-1"></a>  u <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">runif</span>(n<span class="sc">*</span>m), n, m)</span>
<span id="cb31-4"><a href="#cb31-4" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb31-5"><a href="#cb31-5" tabindex="-1"></a>    u[i, ] <span class="ot">=</span> <span class="fu">qs</span>(u[i, ])</span>
<span id="cb31-6"><a href="#cb31-6" tabindex="-1"></a>  }</span>
<span id="cb31-7"><a href="#cb31-7" tabindex="-1"></a>  <span class="fu">return</span>(u[, k])</span>
<span id="cb31-8"><a href="#cb31-8" tabindex="-1"></a>}</span>
<span id="cb31-9"><a href="#cb31-9" tabindex="-1"></a></span>
<span id="cb31-10"><a href="#cb31-10" tabindex="-1"></a><span class="do">## ecdf generator</span></span>
<span id="cb31-11"><a href="#cb31-11" tabindex="-1"></a>beta.ecdf <span class="ot">&lt;-</span> <span class="cf">function</span>(a, b){</span>
<span id="cb31-12"><a href="#cb31-12" tabindex="-1"></a>  k <span class="ot">=</span> a; m <span class="ot">=</span> k <span class="sc">+</span> b <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb31-13"><a href="#cb31-13" tabindex="-1"></a>  n <span class="ot">=</span> <span class="dv">1000</span> <span class="co"># sample size</span></span>
<span id="cb31-14"><a href="#cb31-14" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">kth.gen</span>(n, k, m)</span>
<span id="cb31-15"><a href="#cb31-15" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">ecdf</span>(x))</span>
<span id="cb31-16"><a href="#cb31-16" tabindex="-1"></a>}</span></code></pre></div>
<p>Then we do the Monte Carlo estimation:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a>R <span class="ot">=</span> <span class="dv">500</span> <span class="do">## times of repetitions</span></span>
<span id="cb32-2"><a href="#cb32-2" tabindex="-1"></a>x <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">9</span><span class="sc">/</span><span class="dv">10</span></span>
<span id="cb32-3"><a href="#cb32-3" tabindex="-1"></a>y <span class="ot">=</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(R, <span class="fu">length</span>(x)))</span>
<span id="cb32-4"><a href="#cb32-4" tabindex="-1"></a>est <span class="ot">=</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(x))</span>
<span id="cb32-5"><a href="#cb32-5" tabindex="-1"></a></span>
<span id="cb32-6"><a href="#cb32-6" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>R){</span>
<span id="cb32-7"><a href="#cb32-7" tabindex="-1"></a>  cdf <span class="ot">&lt;-</span> <span class="fu">beta.ecdf</span>(<span class="dv">3</span>, <span class="dv">3</span>)</span>
<span id="cb32-8"><a href="#cb32-8" tabindex="-1"></a>  y[j, ] <span class="ot">=</span> <span class="fu">cdf</span>(x)</span>
<span id="cb32-9"><a href="#cb32-9" tabindex="-1"></a>}</span>
<span id="cb32-10"><a href="#cb32-10" tabindex="-1"></a></span>
<span id="cb32-11"><a href="#cb32-11" tabindex="-1"></a><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(x)){</span>
<span id="cb32-12"><a href="#cb32-12" tabindex="-1"></a>  est[k] <span class="ot">=</span> <span class="fu">mean</span>(y[, k])</span>
<span id="cb32-13"><a href="#cb32-13" tabindex="-1"></a>}</span>
<span id="cb32-14"><a href="#cb32-14" tabindex="-1"></a></span>
<span id="cb32-15"><a href="#cb32-15" tabindex="-1"></a>data <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x, <span class="at">Fn =</span> est, <span class="at">F.real =</span> <span class="fu">pbeta</span>(x, <span class="dv">3</span>, <span class="dv">3</span>))</span></code></pre></div>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(data, <span class="at">align =</span> <span class="fu">c</span>(<span class="st">&quot;l&quot;</span>, <span class="st">&quot;l&quot;</span>, <span class="st">&quot;l&quot;</span>))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">x</th>
<th align="left">Fn</th>
<th align="left">F.real</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">0.1</td>
<td align="left">0.008536</td>
<td align="left">0.00856</td>
</tr>
<tr class="even">
<td align="left">0.2</td>
<td align="left">0.058190</td>
<td align="left">0.05792</td>
</tr>
<tr class="odd">
<td align="left">0.3</td>
<td align="left">0.163096</td>
<td align="left">0.16308</td>
</tr>
<tr class="even">
<td align="left">0.4</td>
<td align="left">0.317350</td>
<td align="left">0.31744</td>
</tr>
<tr class="odd">
<td align="left">0.5</td>
<td align="left">0.499688</td>
<td align="left">0.50000</td>
</tr>
<tr class="even">
<td align="left">0.6</td>
<td align="left">0.683018</td>
<td align="left">0.68256</td>
</tr>
<tr class="odd">
<td align="left">0.7</td>
<td align="left">0.837724</td>
<td align="left">0.83692</td>
</tr>
<tr class="even">
<td align="left">0.8</td>
<td align="left">0.942396</td>
<td align="left">0.94208</td>
</tr>
<tr class="odd">
<td align="left">0.9</td>
<td align="left">0.991472</td>
<td align="left">0.99144</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="antithetic-variables" class="section level2">
<h2>Antithetic variables</h2>
<p>Generate Rayleigh(<span class="math inline">\(\sigma\)</span>)
samples using antithetic variables, and see the percentage of variance
reduction between <span class="math inline">\(\frac{X+X&#39;}{2}\)</span> with <span class="math inline">\(X,X&#39;\)</span> negatively correlated and <span class="math inline">\(\frac{X_1+X_2}{2}\)</span> for independent <span class="math inline">\(X_1, X_2\)</span>s.</p>
<div id="solution-10" class="section level4">
<h4>Solution</h4>
<p>The pdf of Rayleigh(<span class="math inline">\(\sigma\)</span>)
distribution is</p>
<p><span class="math display">\[
f(x) = \frac{x}{\sigma^2}exp(-\frac{x^2}{2\sigma^2}),~x\ge0,\sigma&gt;0.
\]</span></p>
<p>According to the last homework, we have worked out that for <span class="math inline">\(X\sim\)</span> Rayleigh(<span class="math inline">\(\sigma\)</span>),</p>
<p><span class="math display">\[
X = F^{-1}(U) = \sigma\sqrt{2log(\frac{1}{1-U})}.
\]</span></p>
<p>and the sample generator</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" tabindex="-1"></a>gen.Rayleigh <span class="ot">&lt;-</span> <span class="cf">function</span>(n, <span class="at">sigma =</span> <span class="dv">1</span>){</span>
<span id="cb34-2"><a href="#cb34-2" tabindex="-1"></a>  u <span class="ot">=</span> <span class="fu">runif</span>(n)</span>
<span id="cb34-3"><a href="#cb34-3" tabindex="-1"></a>  x <span class="ot">=</span> sigma<span class="sc">*</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>u)))</span>
<span id="cb34-4"><a href="#cb34-4" tabindex="-1"></a>  <span class="fu">return</span>(x)</span>
<span id="cb34-5"><a href="#cb34-5" tabindex="-1"></a>}</span></code></pre></div>
<p>Now we do a few editions on that function, we obtain</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" tabindex="-1"></a>gen.Rayleigh.anti <span class="ot">&lt;-</span> <span class="cf">function</span>(n, <span class="at">sigma =</span> <span class="dv">1</span>){</span>
<span id="cb35-2"><a href="#cb35-2" tabindex="-1"></a>  <span class="fu">stopifnot</span>(n <span class="sc">%%</span> <span class="dv">2</span> <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb35-3"><a href="#cb35-3" tabindex="-1"></a>  m <span class="ot">=</span> n<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb35-4"><a href="#cb35-4" tabindex="-1"></a>  u <span class="ot">=</span> <span class="fu">runif</span>(m)</span>
<span id="cb35-5"><a href="#cb35-5" tabindex="-1"></a>  uu <span class="ot">=</span> <span class="fu">c</span>(u, <span class="dv">1</span> <span class="sc">-</span> u) <span class="do">## antithetic variables</span></span>
<span id="cb35-6"><a href="#cb35-6" tabindex="-1"></a>  x <span class="ot">=</span> sigma<span class="sc">*</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>uu)))</span>
<span id="cb35-7"><a href="#cb35-7" tabindex="-1"></a>  <span class="fu">return</span>(x)</span>
<span id="cb35-8"><a href="#cb35-8" tabindex="-1"></a>}</span></code></pre></div>
<p>We set <span class="math inline">\(\sigma = 1\)</span> as default,
sample size <span class="math inline">\(n=500\)</span>,</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" tabindex="-1"></a>x1 <span class="ot">=</span> <span class="fu">gen.Rayleigh.anti</span>(<span class="dv">500</span>)</span>
<span id="cb36-2"><a href="#cb36-2" tabindex="-1"></a>x2 <span class="ot">=</span> <span class="fu">gen.Rayleigh</span>(<span class="dv">500</span>)</span>
<span id="cb36-3"><a href="#cb36-3" tabindex="-1"></a></span>
<span id="cb36-4"><a href="#cb36-4" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb36-5"><a href="#cb36-5" tabindex="-1"></a>  m <span class="ot">=</span> <span class="fu">length</span>(x)</span>
<span id="cb36-6"><a href="#cb36-6" tabindex="-1"></a>  <span class="fu">stopifnot</span>(m <span class="sc">%%</span> <span class="dv">2</span> <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb36-7"><a href="#cb36-7" tabindex="-1"></a>  y <span class="ot">=</span> (x[<span class="dv">1</span><span class="sc">:</span>(m<span class="sc">/</span><span class="dv">2</span>)] <span class="sc">+</span> x[(m<span class="sc">/</span><span class="dv">2</span> <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>m]) <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb36-8"><a href="#cb36-8" tabindex="-1"></a>  <span class="fu">return</span>(y)</span>
<span id="cb36-9"><a href="#cb36-9" tabindex="-1"></a>}</span>
<span id="cb36-10"><a href="#cb36-10" tabindex="-1"></a></span>
<span id="cb36-11"><a href="#cb36-11" tabindex="-1"></a>y1 <span class="ot">=</span> <span class="fu">f</span>(x1)</span>
<span id="cb36-12"><a href="#cb36-12" tabindex="-1"></a>y2 <span class="ot">=</span> <span class="fu">f</span>(x2)</span>
<span id="cb36-13"><a href="#cb36-13" tabindex="-1"></a></span>
<span id="cb36-14"><a href="#cb36-14" tabindex="-1"></a>var.anti <span class="ot">=</span> <span class="fu">var</span>(y1) <span class="do">## antithetic method</span></span>
<span id="cb36-15"><a href="#cb36-15" tabindex="-1"></a>var.indp <span class="ot">=</span> <span class="fu">var</span>(y2) <span class="do">## independent sampling</span></span>
<span id="cb36-16"><a href="#cb36-16" tabindex="-1"></a></span>
<span id="cb36-17"><a href="#cb36-17" tabindex="-1"></a>(var.indp <span class="sc">-</span> var.anti)<span class="sc">/</span>var.indp <span class="do">## percentage of variance reduction</span></span></code></pre></div>
<pre><code>## [1] 0.9443502</code></pre>
</div>
</div>
<div id="importance-sampling" class="section level2">
<h2>Importance Sampling</h2>
<p>Find two importance functions supported on <span class="math inline">\((1,\infty)\)</span> that are close to <span class="math inline">\(g(x)=\frac{x^2}{\sqrt{2\pi}}e^{-x^2/2},
x&gt;1\)</span>, estimating the integral</p>
<p><span class="math display">\[
I = \int_1^\infty g(x)dx = \int_1^\infty
\frac{x^2}{\sqrt{2\pi}}e^{-x^2/2} dx.
\]</span></p>
<p>Compare and explain the variance created by different importance
functions.</p>
<div id="solution-11" class="section level4">
<h4>Solution</h4>
<p>Note that the pdf of Rayleigh(<span class="math inline">\(\sigma\)</span>) is</p>
<p><span class="math display">\[
f(x) = \frac{x}{\sigma^2}exp(-\frac{x^2}{2\sigma^2}),~x\ge0,\sigma&gt;0,
\]</span></p>
<p>then we let <span class="math inline">\(\sigma = 1\)</span>, and
<span class="math inline">\(X = Y*I\{Y&gt;1\}\)</span>, where <span class="math inline">\(Y\sim\)</span> Rayleigh(<span class="math inline">\(1\)</span>), and <span class="math inline">\(I\{\cdot\}\)</span> is the indicator function.
Then <span class="math inline">\(X\)</span> is supported on <span class="math inline">\((1,\infty)\)</span> with pdf:</p>
<p><span class="math display">\[
f_1(x) = \frac{1}{1 - F(1)} f(x) = e^{1/2}~x~exp(-\frac{x^2}{2}),~x &gt;
1,
\]</span></p>
<p>where <span class="math inline">\(F(x)\)</span> is the cdf of
Rayleigh(<span class="math inline">\(1\)</span>):</p>
<p><span class="math display">\[
F(x)=1 - exp(-\frac{x^2}{2}),~x\ge0.
\]</span></p>
<p>Thus we have</p>
<p><span class="math display">\[
I = \int_1^\infty \frac{g(x)}{f_1(x)}f_1(x)dx =
\frac{1}{\sqrt{2\pi}e^{1/2}}\mathrm{E}_{f_1}\left[X\right].
\]</span></p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" tabindex="-1"></a>theta.f1 <span class="ot">&lt;-</span> <span class="cf">function</span>(n){</span>
<span id="cb38-2"><a href="#cb38-2" tabindex="-1"></a>  k <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb38-3"><a href="#cb38-3" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb38-4"><a href="#cb38-4" tabindex="-1"></a>  <span class="cf">repeat</span>{</span>
<span id="cb38-5"><a href="#cb38-5" tabindex="-1"></a>    uu <span class="ot">=</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb38-6"><a href="#cb38-6" tabindex="-1"></a>    <span class="cf">if</span> (uu <span class="sc">&gt;</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)){ <span class="do">## F(1) = 1 - exp(-1/2)</span></span>
<span id="cb38-7"><a href="#cb38-7" tabindex="-1"></a>      u <span class="ot">&lt;-</span> <span class="fu">c</span>(u, uu)</span>
<span id="cb38-8"><a href="#cb38-8" tabindex="-1"></a>      k <span class="ot">&lt;-</span> k <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb38-9"><a href="#cb38-9" tabindex="-1"></a>    }</span>
<span id="cb38-10"><a href="#cb38-10" tabindex="-1"></a>    <span class="cf">if</span> (k <span class="sc">==</span> n) {<span class="cf">break</span>}</span>
<span id="cb38-11"><a href="#cb38-11" tabindex="-1"></a>  }</span>
<span id="cb38-12"><a href="#cb38-12" tabindex="-1"></a>  x <span class="ot">=</span> <span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>u)))</span>
<span id="cb38-13"><a href="#cb38-13" tabindex="-1"></a>  <span class="fu">return</span>(x)</span>
<span id="cb38-14"><a href="#cb38-14" tabindex="-1"></a>}</span></code></pre></div>
<p>We consider</p>
<p><span class="math display">\[
f_2(x)=\frac{1}{\sqrt{2\pi}(1-\Phi(1))}e^{-x^2/2}, x &gt; 1,
\]</span></p>
<p>where <span class="math inline">\(\Phi(x)\)</span> is the cdf of
standard normal distribution. Let <span class="math inline">\(X=
Y*I\{Y&gt;1\}\)</span> where <span class="math inline">\(Y\sim N(0,
1)\)</span>, then <span class="math inline">\(f_2\)</span> is the pdf of
<span class="math inline">\(X\)</span>.</p>
<p><span class="math display">\[
I = \int_1^\infty\frac{g(x)}{f_2(x)} f_2(x)dx= (1-\Phi(1))\int_1^\infty
x^2f_2(x)dx = (1-\Phi(1))\mathrm{E}_{f_2}\left[X^2\right].
\]</span></p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" tabindex="-1"></a>theta.f2 <span class="ot">&lt;-</span> <span class="cf">function</span>(n){</span>
<span id="cb39-2"><a href="#cb39-2" tabindex="-1"></a>  k <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb39-3"><a href="#cb39-3" tabindex="-1"></a>  x <span class="ot">=</span> <span class="cn">NULL</span></span>
<span id="cb39-4"><a href="#cb39-4" tabindex="-1"></a>  <span class="cf">repeat</span>{</span>
<span id="cb39-5"><a href="#cb39-5" tabindex="-1"></a>    xx <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">1</span>)</span>
<span id="cb39-6"><a href="#cb39-6" tabindex="-1"></a>    <span class="cf">if</span> (xx <span class="sc">&gt;</span> <span class="dv">1</span>) {x <span class="ot">=</span> <span class="fu">c</span>(x, xx); k <span class="ot">=</span> k <span class="sc">+</span> <span class="dv">1</span>}</span>
<span id="cb39-7"><a href="#cb39-7" tabindex="-1"></a>    <span class="cf">if</span> (k <span class="sc">==</span> n){<span class="cf">break</span>}</span>
<span id="cb39-8"><a href="#cb39-8" tabindex="-1"></a>  }</span>
<span id="cb39-9"><a href="#cb39-9" tabindex="-1"></a>  <span class="fu">return</span>(x<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb39-10"><a href="#cb39-10" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">500</span> <span class="do">## sample size</span></span>
<span id="cb40-2"><a href="#cb40-2" tabindex="-1"></a>c1 <span class="ot">=</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)</span>
<span id="cb40-3"><a href="#cb40-3" tabindex="-1"></a>c2 <span class="ot">=</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">pnorm</span>(<span class="dv">1</span>)</span>
<span id="cb40-4"><a href="#cb40-4" tabindex="-1"></a></span>
<span id="cb40-5"><a href="#cb40-5" tabindex="-1"></a><span class="do">## Monte Carlo estimation</span></span>
<span id="cb40-6"><a href="#cb40-6" tabindex="-1"></a>theta1 <span class="ot">&lt;-</span>  <span class="fu">theta.f1</span>(n)</span>
<span id="cb40-7"><a href="#cb40-7" tabindex="-1"></a>intgral.hat1 <span class="ot">&lt;-</span> c1 <span class="sc">*</span> <span class="fu">mean</span>(theta1)</span>
<span id="cb40-8"><a href="#cb40-8" tabindex="-1"></a>var1 <span class="ot">&lt;-</span> c1<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">var</span>(theta1)</span>
<span id="cb40-9"><a href="#cb40-9" tabindex="-1"></a></span>
<span id="cb40-10"><a href="#cb40-10" tabindex="-1"></a>theta2 <span class="ot">&lt;-</span> <span class="fu">theta.f2</span>(n)</span>
<span id="cb40-11"><a href="#cb40-11" tabindex="-1"></a>intgral.hat2 <span class="ot">&lt;-</span> c2<span class="sc">*</span> <span class="fu">mean</span>(theta2)</span>
<span id="cb40-12"><a href="#cb40-12" tabindex="-1"></a>var2 <span class="ot">&lt;-</span> c2<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">var</span>(theta2)</span></code></pre></div>
<p>Results are:</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" tabindex="-1"></a>intgral.hat1 <span class="do">## f_1</span></span></code></pre></div>
<pre><code>## [1] 0.4099544</code></pre>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" tabindex="-1"></a>intgral.hat2 <span class="do">## f_2</span></span></code></pre></div>
<pre><code>## [1] 0.4183005</code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" tabindex="-1"></a>var1 <span class="do">## f_1</span></span></code></pre></div>
<pre><code>## [1] 0.01601788</code></pre>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" tabindex="-1"></a>var2 <span class="do">## f_2</span></span></code></pre></div>
<pre><code>## [1] 0.08618265</code></pre>
<p>We can observe that function <span class="math inline">\(f_1\)</span>
produces smaller variance than <span class="math inline">\(f_2\)</span>,
this is because <span class="math inline">\(f_1\)</span> is closer to
<span class="math inline">\(g\)</span> than <span class="math inline">\(f_2\)</span>.</p>
</div>
</div>
<div id="skewness-test-statistic-sqrtb_1" class="section level2">
<h2>skewness test statistic <span class="math inline">\(\sqrt{b_1}\)</span></h2>
<p>Estimate the <span class="math inline">\(0.025, 0.050, 0.950,
0.975\)</span> quantiles of sample skewness <span class="math inline">\(\sqrt{b_1}\)</span> under normality in a Monte
Carlo experiment.</p>
<div id="solution-12" class="section level4">
<h4>Solution</h4>
<p>First we write a function to compute the sample skewness
statistic.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" tabindex="-1"></a>sk <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {<span class="do">## computes the sample skewness coefficient</span></span>
<span id="cb49-2"><a href="#cb49-2" tabindex="-1"></a>  xbar <span class="ot">&lt;-</span> <span class="fu">mean</span>(x)</span>
<span id="cb49-3"><a href="#cb49-3" tabindex="-1"></a>  m3 <span class="ot">&lt;-</span> <span class="fu">mean</span>((x <span class="sc">-</span> xbar)<span class="sc">^</span><span class="dv">3</span>)</span>
<span id="cb49-4"><a href="#cb49-4" tabindex="-1"></a>  m2 <span class="ot">&lt;-</span> <span class="fu">mean</span>((x <span class="sc">-</span> xbar)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb49-5"><a href="#cb49-5" tabindex="-1"></a>  <span class="fu">return</span>( m3 <span class="sc">/</span> m2<span class="sc">^</span><span class="fl">1.5</span> )</span>
<span id="cb49-6"><a href="#cb49-6" tabindex="-1"></a>}</span></code></pre></div>
<p>Then we perform the Monte Carlo experiment.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">500</span> <span class="do">## sample size</span></span>
<span id="cb50-2"><a href="#cb50-2" tabindex="-1"></a>m <span class="ot">=</span> <span class="dv">1000</span> <span class="do">## times of simulations</span></span>
<span id="cb50-3"><a href="#cb50-3" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.05</span>, <span class="fl">0.95</span>, <span class="fl">0.975</span>)</span>
<span id="cb50-4"><a href="#cb50-4" tabindex="-1"></a>b1 <span class="ot">=</span> <span class="fu">numeric</span>(m) <span class="do">## storing sample skewness</span></span>
<span id="cb50-5"><a href="#cb50-5" tabindex="-1"></a></span>
<span id="cb50-6"><a href="#cb50-6" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb50-7"><a href="#cb50-7" tabindex="-1"></a>  x <span class="ot">=</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb50-8"><a href="#cb50-8" tabindex="-1"></a>  b1[i] <span class="ot">=</span> <span class="fu">sk</span>(x)</span>
<span id="cb50-9"><a href="#cb50-9" tabindex="-1"></a>}</span>
<span id="cb50-10"><a href="#cb50-10" tabindex="-1"></a></span>
<span id="cb50-11"><a href="#cb50-11" tabindex="-1"></a>q_emp <span class="ot">=</span> <span class="fu">quantile</span>(b1, alpha) <span class="do">## empirical quantiles</span></span>
<span id="cb50-12"><a href="#cb50-12" tabindex="-1"></a></span>
<span id="cb50-13"><a href="#cb50-13" tabindex="-1"></a>q_asy <span class="ot">=</span> <span class="fu">qnorm</span>(alpha, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="fu">sqrt</span>(<span class="dv">6</span><span class="sc">/</span>n)) <span class="do">## asymptotic quantiles</span></span></code></pre></div>
<p>Compare empirical quantiles with asymptotic ones:</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" tabindex="-1"></a><span class="fu">rbind</span>(q_emp, q_asy)</span></code></pre></div>
<pre><code>##             2.5%         5%       95%     97.5%
## q_emp -0.2217401 -0.1866172 0.1868298 0.2250379
## q_asy -0.2147033 -0.1801847 0.1801847 0.2147033</code></pre>
<p>Compute the standard error of empirical quantiles using normal
approximation for the density:</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" tabindex="-1"></a>sd <span class="ot">=</span> <span class="fu">sqrt</span>(alpha<span class="sc">*</span>(<span class="dv">1</span> <span class="sc">-</span> alpha)<span class="sc">/</span>(n <span class="sc">*</span> <span class="fu">dnorm</span>(q_asy)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb53-2"><a href="#cb53-2" tabindex="-1"></a><span class="fu">rbind</span>(alpha, sd)</span></code></pre></div>
<pre><code>##             [,1]       [,2]       [,3]       [,4]
## alpha 0.02500000 0.05000000 0.95000000 0.97500000
## sd    0.01790965 0.02483143 0.02483143 0.01790965</code></pre>
</div>
</div>
<div id="powers-of-correlation-tests" class="section level2">
<h2>Powers of correlation tests</h2>
<p>Tests for association based on Pearson product moment correlation
<span class="math inline">\(\rho\)</span>, Spearman’s rank correlation
coefficient <span class="math inline">\(\rho_s\)</span>, or Kendall’s
coefficient <span class="math inline">\(\tau\)</span>, are implemented
in <code>cor.test</code>. Show (empirically) that the nonparametric
tests based on <span class="math inline">\(\rho_s\)</span> or <span class="math inline">\(\tau\)</span> are less powerful than the
correlation test when the sampled distribution is bivariate normal. Find
an example of an alternative (a bivariate distribution <span class="math inline">\((X, Y )\)</span> such that <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are dependent) such that at least one
of the nonparametric tests have better empirical power than the
correlation test against this alternative.</p>
<div id="solution-13" class="section level4">
<h4>Solution</h4>
<p>First we write a bivariate copula to generate samples.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb55-2"><a href="#cb55-2" tabindex="-1"></a>sim.copula <span class="ot">&lt;-</span> <span class="cf">function</span>(n, rho, qm1, qm2){</span>
<span id="cb55-3"><a href="#cb55-3" tabindex="-1"></a>  mu <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">2</span>)</span>
<span id="cb55-4"><a href="#cb55-4" tabindex="-1"></a>  M <span class="ot">&lt;-</span> <span class="fu">matrix</span>(rho, <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb55-5"><a href="#cb55-5" tabindex="-1"></a>  <span class="fu">diag</span>(M) <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb55-6"><a href="#cb55-6" tabindex="-1"></a>  dat <span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(n, mu, M)</span>
<span id="cb55-7"><a href="#cb55-7" tabindex="-1"></a>  dat[,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">qm1</span>(<span class="fu">pnorm</span>(dat[,<span class="dv">1</span>]))</span>
<span id="cb55-8"><a href="#cb55-8" tabindex="-1"></a>  dat[,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">qm2</span>(<span class="fu">pnorm</span>(dat[,<span class="dv">2</span>]))</span>
<span id="cb55-9"><a href="#cb55-9" tabindex="-1"></a>  <span class="fu">return</span>(dat)</span>
<span id="cb55-10"><a href="#cb55-10" tabindex="-1"></a>}</span></code></pre></div>
<p>And then we write a function for doing Monte Carlo experiments, under
marginals <code>qm1</code> and <code>qm2</code>.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" tabindex="-1"></a>simu <span class="ot">&lt;-</span> <span class="cf">function</span>(n, m, rho.all, <span class="at">alpha =</span> <span class="fl">0.05</span>, qm1, qm2){</span>
<span id="cb56-2"><a href="#cb56-2" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="fu">length</span>(rho.all), m))</span>
<span id="cb56-3"><a href="#cb56-3" tabindex="-1"></a>  <span class="do">## test results of Pearson, Spearman, Kendall respectively</span></span>
<span id="cb56-4"><a href="#cb56-4" tabindex="-1"></a></span>
<span id="cb56-5"><a href="#cb56-5" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(rho.all)){</span>
<span id="cb56-6"><a href="#cb56-6" tabindex="-1"></a>    rho <span class="ot">=</span> rho.all[i]</span>
<span id="cb56-7"><a href="#cb56-7" tabindex="-1"></a>    </span>
<span id="cb56-8"><a href="#cb56-8" tabindex="-1"></a>    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb56-9"><a href="#cb56-9" tabindex="-1"></a>      dat <span class="ot">=</span> <span class="fu">sim.copula</span>(n, rho, qm1, qm2)</span>
<span id="cb56-10"><a href="#cb56-10" tabindex="-1"></a>      </span>
<span id="cb56-11"><a href="#cb56-11" tabindex="-1"></a>      res[<span class="dv">1</span>, i, j] <span class="ot">=</span> (<span class="fu">cor.test</span>(dat[, <span class="dv">1</span>], dat[, <span class="dv">2</span>])<span class="sc">$</span>p.value <span class="sc">&lt;</span> alpha)</span>
<span id="cb56-12"><a href="#cb56-12" tabindex="-1"></a>      res[<span class="dv">2</span>, i, j] <span class="ot">=</span> </span>
<span id="cb56-13"><a href="#cb56-13" tabindex="-1"></a>        (<span class="fu">cor.test</span>(dat[, <span class="dv">1</span>], dat[, <span class="dv">2</span>], <span class="at">method =</span> <span class="st">&quot;spearm&quot;</span>)<span class="sc">$</span>p.value <span class="sc">&lt;</span> alpha)</span>
<span id="cb56-14"><a href="#cb56-14" tabindex="-1"></a>      res[<span class="dv">3</span>, i, j] <span class="ot">=</span> </span>
<span id="cb56-15"><a href="#cb56-15" tabindex="-1"></a>        (<span class="fu">cor.test</span>(dat[, <span class="dv">1</span>], dat[, <span class="dv">2</span>], <span class="at">method =</span> <span class="st">&quot;kendall&quot;</span>)<span class="sc">$</span>p.value <span class="sc">&lt;</span> alpha)</span>
<span id="cb56-16"><a href="#cb56-16" tabindex="-1"></a>    }</span>
<span id="cb56-17"><a href="#cb56-17" tabindex="-1"></a>  }</span>
<span id="cb56-18"><a href="#cb56-18" tabindex="-1"></a>  </span>
<span id="cb56-19"><a href="#cb56-19" tabindex="-1"></a>  <span class="fu">return</span>(res)</span>
<span id="cb56-20"><a href="#cb56-20" tabindex="-1"></a>}</span></code></pre></div>
<p>Before experiment begins, we set some global variables as</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">500</span> <span class="do">## sample size</span></span>
<span id="cb57-2"><a href="#cb57-2" tabindex="-1"></a>m <span class="ot">=</span> <span class="dv">500</span> <span class="do">## simulations</span></span>
<span id="cb57-3"><a href="#cb57-3" tabindex="-1"></a>alpha <span class="ot">=</span> <span class="fl">0.05</span> <span class="do">## significance level</span></span>
<span id="cb57-4"><a href="#cb57-4" tabindex="-1"></a>rho.all <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.10</span>, <span class="fl">0.15</span>)</span></code></pre></div>
<p>When the sampled distribution is bivariate normal:</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">simu</span>(n, m, rho.all, alpha, qnorm, qnorm)</span></code></pre></div>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" tabindex="-1"></a>power1 <span class="ot">=</span> <span class="fu">numeric</span>(<span class="fu">length</span>(rho.all))</span>
<span id="cb59-2"><a href="#cb59-2" tabindex="-1"></a>power2 <span class="ot">=</span> <span class="fu">numeric</span>(<span class="fu">length</span>(rho.all))</span>
<span id="cb59-3"><a href="#cb59-3" tabindex="-1"></a>power3 <span class="ot">=</span> <span class="fu">numeric</span>(<span class="fu">length</span>(rho.all))</span>
<span id="cb59-4"><a href="#cb59-4" tabindex="-1"></a></span>
<span id="cb59-5"><a href="#cb59-5" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(rho.all)){</span>
<span id="cb59-6"><a href="#cb59-6" tabindex="-1"></a>  power1[i] <span class="ot">=</span> <span class="fu">mean</span>(res[<span class="dv">1</span>, i, ]) <span class="do">## pearson</span></span>
<span id="cb59-7"><a href="#cb59-7" tabindex="-1"></a>  power2[i] <span class="ot">=</span> <span class="fu">mean</span>(res[<span class="dv">2</span>, i, ]) <span class="do">## spearman</span></span>
<span id="cb59-8"><a href="#cb59-8" tabindex="-1"></a>  power3[i] <span class="ot">=</span> <span class="fu">mean</span>(res[<span class="dv">3</span>, i, ]) <span class="do">## kendall</span></span>
<span id="cb59-9"><a href="#cb59-9" tabindex="-1"></a>}</span>
<span id="cb59-10"><a href="#cb59-10" tabindex="-1"></a></span>
<span id="cb59-11"><a href="#cb59-11" tabindex="-1"></a><span class="fu">rbind</span>(rho.all, power1, power2, power3)</span></code></pre></div>
<pre><code>##          [,1]  [,2]  [,3]
## rho.all 0.050 0.100 0.150
## power1  0.218 0.642 0.922
## power2  0.196 0.582 0.880
## power3  0.194 0.580 0.878</code></pre>
<p>As we can see, the nonparametric tests based on <span class="math inline">\(\rho_s\)</span> or <span class="math inline">\(\tau\)</span> are less powerful than the
correlation test when the sampled distribution is bivariate normal.</p>
<p>Now we try other marginal distributions, using copula to generate
dependent samples.</p>
<p>For example, <span class="math inline">\(X\sim N(0, 1)\)</span> and
<span class="math inline">\(Y\sim \mathrm{Exp}(1)\)</span>:</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">simu</span>(n, m, rho.all, alpha, qnorm, qexp)</span></code></pre></div>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" tabindex="-1"></a>power1 <span class="ot">=</span> <span class="fu">numeric</span>(<span class="fu">length</span>(rho.all))</span>
<span id="cb62-2"><a href="#cb62-2" tabindex="-1"></a>power2 <span class="ot">=</span> <span class="fu">numeric</span>(<span class="fu">length</span>(rho.all))</span>
<span id="cb62-3"><a href="#cb62-3" tabindex="-1"></a>power3 <span class="ot">=</span> <span class="fu">numeric</span>(<span class="fu">length</span>(rho.all))</span>
<span id="cb62-4"><a href="#cb62-4" tabindex="-1"></a></span>
<span id="cb62-5"><a href="#cb62-5" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(rho.all)){</span>
<span id="cb62-6"><a href="#cb62-6" tabindex="-1"></a>  power1[i] <span class="ot">=</span> <span class="fu">mean</span>(res[<span class="dv">1</span>, i, ]) <span class="do">## pearson</span></span>
<span id="cb62-7"><a href="#cb62-7" tabindex="-1"></a>  power2[i] <span class="ot">=</span> <span class="fu">mean</span>(res[<span class="dv">2</span>, i, ]) <span class="do">## spearman</span></span>
<span id="cb62-8"><a href="#cb62-8" tabindex="-1"></a>  power3[i] <span class="ot">=</span> <span class="fu">mean</span>(res[<span class="dv">3</span>, i, ]) <span class="do">## kendall</span></span>
<span id="cb62-9"><a href="#cb62-9" tabindex="-1"></a>}</span>
<span id="cb62-10"><a href="#cb62-10" tabindex="-1"></a></span>
<span id="cb62-11"><a href="#cb62-11" tabindex="-1"></a><span class="fu">rbind</span>(rho.all, power1, power2, power3)</span></code></pre></div>
<pre><code>##          [,1]  [,2]  [,3]
## rho.all 0.050 0.100 0.150
## power1  0.136 0.538 0.860
## power2  0.158 0.592 0.894
## power3  0.158 0.594 0.890</code></pre>
<p>As is shown, under normal &amp; exponential marginals, the
nonparametric methods perform better than Pearson’s correlation
test.</p>
</div>
</div>
<div id="discussion" class="section level2">
<h2>Discussion</h2>
<p>If we obtain the powers for two methods under a particular simulation
setting with <span class="math inline">\(10,000\)</span> experiments:
say, <span class="math inline">\(0.651\)</span> for one method and <span class="math inline">\(0.676\)</span> for another method. We want to know
if the powers are different at <span class="math inline">\(0.05\)</span>
level.</p>
<div id="what-is-the-corresponding-hypothesis-test-problem" class="section level4">
<h4>What is the corresponding hypothesis test problem?</h4>
<p><span class="math display">\[
H_0: \text{the theoretical powers of these two methods are
equal;}~~H_1:\text{they are not equal.}
\]</span></p>
<p>Denote the theoretical powers by <span class="math inline">\(p_1,p_2\)</span> for these two methods
respectively. Then rewrite <span class="math inline">\(H_0,H_1\)</span>:</p>
<p><span class="math display">\[
H_0: p_1 = p_2;~~H_1:p_1\neq p_2.
\]</span></p>
</div>
<div id="what-test-should-we-use" class="section level4">
<h4>What test should we use?</h4>
<p>(Z-test, two-sample t-test, paired-t test or McNemar test? Why?)</p>
<p>Suppose that the null hypothesis holds, and this power denoted by
<span class="math inline">\(p_1 = p_2 = p\)</span>. Denote the Monte
Carlo powers of method one by <span class="math inline">\(\hat
p_1\)</span> (while the other denoted by <span class="math inline">\(\hat p_2\)</span>). Then <span class="math inline">\(n\hat p_1\sim n\hat p_2\sim\mathrm{Binomial}(n,
p)\)</span>, where <span class="math inline">\(n =10000\)</span> denotes
the times of simulations.</p>
<p>Although this test could be done with both <strong>two-sample
t-test</strong> and <strong>McNemar test</strong>, I think the former
test might performs better, as <span class="math inline">\(\hat p_i, i =
1,2\)</span> are both asymptotically normal, while the latter one
doesn’t rely on this.</p>
</div>
<div id="provide-the-least-necessary-information-for-hypothesis-testing" class="section level4">
<h4>Provide the least necessary information for hypothesis testing</h4>
<p>Suppose that <span class="math inline">\(H_0\)</span> hold, then</p>
<p><span class="math display">\[
z=\frac{\hat p_1-\hat p_2}{\sqrt{\hat p(1-\hat
p)\left(\frac{1}{n_1}+\frac{1}{n_2}\right)}}\rightarrow N(0, 1)
\]</span></p>
<p>where <span class="math inline">\(\hat p=\frac{n_1\hat p_1+n_2\hat
p_2}{n_1+n_2}=\frac{\hat p_1+\hat p_2}{2}=0.6635,\hat p_1=0.651,\hat p_2
= 0.676, n_1 = n_2= 10000\)</span>.</p>
<p><span class="math inline">\(\alpha = 0.05\)</span>, if <span class="math inline">\(|z|&gt;z_{\alpha/2} = 1.96\)</span>, then reject
<span class="math inline">\(H_0\)</span>.</p>
</div>
</div>
<div id="test-problems" class="section level2">
<h2>Test Problems</h2>
<p>Of <span class="math inline">\(1000\)</span> hypotheses, <span class="math inline">\(950\)</span> are null and <span class="math inline">\(50\)</span> are alternative.</p>
<p>First calculate p-values for all the tests;</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" tabindex="-1"></a>N <span class="ot">=</span> <span class="dv">1000</span></span>
<span id="cb64-2"><a href="#cb64-2" tabindex="-1"></a>M <span class="ot">=</span> <span class="dv">950</span></span>
<span id="cb64-3"><a href="#cb64-3" tabindex="-1"></a>H <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>, M), <span class="fu">rep</span>(<span class="dv">1</span>, N<span class="sc">-</span>M)) <span class="do">## type of hypothesis</span></span>
<span id="cb64-4"><a href="#cb64-4" tabindex="-1"></a></span>
<span id="cb64-5"><a href="#cb64-5" tabindex="-1"></a>p.original <span class="ot">&lt;-</span> <span class="cf">function</span>(N, M){</span>
<span id="cb64-6"><a href="#cb64-6" tabindex="-1"></a>  p.null <span class="ot">=</span> <span class="fu">runif</span>(M)</span>
<span id="cb64-7"><a href="#cb64-7" tabindex="-1"></a>  p.alter <span class="ot">=</span> <span class="fu">rbeta</span>(N<span class="sc">-</span>M, <span class="fl">0.1</span>, <span class="dv">1</span>)</span>
<span id="cb64-8"><a href="#cb64-8" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">c</span>(p.null, p.alter))</span>
<span id="cb64-9"><a href="#cb64-9" tabindex="-1"></a>}</span></code></pre></div>
<p>Then adjust them using Bonferroni and BH methods;</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" tabindex="-1"></a>adj <span class="ot">&lt;-</span> <span class="cf">function</span>(p.value){</span>
<span id="cb65-2"><a href="#cb65-2" tabindex="-1"></a>  p.Bon <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(p.value, <span class="at">method =</span> <span class="st">&quot;bonferroni&quot;</span>)</span>
<span id="cb65-3"><a href="#cb65-3" tabindex="-1"></a>  p.BH <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(p.value, <span class="at">method =</span> <span class="st">&quot;BH&quot;</span>)</span>
<span id="cb65-4"><a href="#cb65-4" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">rbind</span>(p.Bon, p.BH))</span>
<span id="cb65-5"><a href="#cb65-5" tabindex="-1"></a>}</span></code></pre></div>
<p>Calculate FWER(family-wise error rate), FDR(false discover rate), and
TPR(true positive rate) under nominal level <span class="math inline">\(\alpha = 0.1\)</span> for each of these two
methods respectively based on <span class="math inline">\(m=10000\)</span> replications.</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" tabindex="-1"></a>alpha <span class="ot">=</span> <span class="fl">0.1</span></span>
<span id="cb66-2"><a href="#cb66-2" tabindex="-1"></a>m <span class="ot">=</span> <span class="dv">10000</span></span>
<span id="cb66-3"><a href="#cb66-3" tabindex="-1"></a>TypeIerror <span class="ot">&lt;-</span> true_positive <span class="ot">&lt;-</span> rejected <span class="ot">&lt;-</span>  <span class="fu">array</span>(<span class="dv">0</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="dv">3</span>, m)) <span class="do">## frequencies</span></span>
<span id="cb66-4"><a href="#cb66-4" tabindex="-1"></a>FWER <span class="ot">&lt;-</span> FDR <span class="ot">&lt;-</span> TPR <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">2</span>)</span>
<span id="cb66-5"><a href="#cb66-5" tabindex="-1"></a></span>
<span id="cb66-6"><a href="#cb66-6" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb66-7"><a href="#cb66-7" tabindex="-1"></a>  p.value <span class="ot">&lt;-</span> <span class="fu">p.original</span>(N, M)</span>
<span id="cb66-8"><a href="#cb66-8" tabindex="-1"></a>  p.adj <span class="ot">&lt;-</span> <span class="fu">adj</span>(p.value)</span>
<span id="cb66-9"><a href="#cb66-9" tabindex="-1"></a>  <span class="do">## original</span></span>
<span id="cb66-10"><a href="#cb66-10" tabindex="-1"></a>  TypeIerror[<span class="dv">1</span>, j] <span class="ot">=</span> <span class="fu">sum</span>(p.value[<span class="dv">1</span><span class="sc">:</span>M] <span class="sc">&lt;</span> alpha)</span>
<span id="cb66-11"><a href="#cb66-11" tabindex="-1"></a>  true_positive[<span class="dv">1</span>, j] <span class="ot">=</span> <span class="fu">sum</span>(p.value[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span>M)] <span class="sc">&lt;</span> alpha)</span>
<span id="cb66-12"><a href="#cb66-12" tabindex="-1"></a>  rejected[<span class="dv">1</span>, j] <span class="ot">=</span> <span class="fu">sum</span>(p.value <span class="sc">&lt;</span> alpha)</span>
<span id="cb66-13"><a href="#cb66-13" tabindex="-1"></a>  <span class="do">## adjusted</span></span>
<span id="cb66-14"><a href="#cb66-14" tabindex="-1"></a>  <span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>){</span>
<span id="cb66-15"><a href="#cb66-15" tabindex="-1"></a>    TypeIerror[k, j] <span class="ot">=</span> <span class="fu">sum</span>(p.adj[k<span class="dv">-1</span>, <span class="dv">1</span><span class="sc">:</span>M] <span class="sc">&lt;</span> alpha)</span>
<span id="cb66-16"><a href="#cb66-16" tabindex="-1"></a>    true_positive[k, j] <span class="ot">=</span> <span class="fu">sum</span>(p.adj[k<span class="dv">-1</span>, <span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span>M)] <span class="sc">&lt;</span> alpha)</span>
<span id="cb66-17"><a href="#cb66-17" tabindex="-1"></a>    rejected[k, j] <span class="ot">&lt;-</span> <span class="fu">sum</span>(p.adj[k<span class="dv">-1</span>, ] <span class="sc">&lt;</span> alpha)</span>
<span id="cb66-18"><a href="#cb66-18" tabindex="-1"></a>  }</span>
<span id="cb66-19"><a href="#cb66-19" tabindex="-1"></a>}</span>
<span id="cb66-20"><a href="#cb66-20" tabindex="-1"></a></span>
<span id="cb66-21"><a href="#cb66-21" tabindex="-1"></a><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>){</span>
<span id="cb66-22"><a href="#cb66-22" tabindex="-1"></a>  FWER[k] <span class="ot">&lt;-</span> <span class="fu">sum</span>(TypeIerror[k, ] <span class="sc">&gt;=</span> <span class="dv">1</span>)<span class="sc">/</span>m</span>
<span id="cb66-23"><a href="#cb66-23" tabindex="-1"></a>  FDR[k] <span class="ot">&lt;-</span> <span class="fu">mean</span>(TypeIerror[k, ]<span class="sc">/</span>rejected[k, ])</span>
<span id="cb66-24"><a href="#cb66-24" tabindex="-1"></a>  TPR[k] <span class="ot">&lt;-</span> <span class="fu">mean</span>(true_positive[k, ])<span class="sc">/</span>(N<span class="sc">-</span>M)</span>
<span id="cb66-25"><a href="#cb66-25" tabindex="-1"></a>}</span>
<span id="cb66-26"><a href="#cb66-26" tabindex="-1"></a></span>
<span id="cb66-27"><a href="#cb66-27" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(FWER, FDR, TPR, <span class="at">row.names =</span> <span class="fu">c</span>(<span class="st">&quot;Original&quot;</span>, <span class="st">&quot;Bon&quot;</span>, <span class="st">&quot;B-H&quot;</span>))</span>
<span id="cb66-28"><a href="#cb66-28" tabindex="-1"></a><span class="fu">print</span>(res)</span></code></pre></div>
<pre><code>##            FWER         FDR      TPR
## Original 1.0000 0.704148190 0.793566
## Bon      0.0892 0.004561137 0.397934
## B-H      0.9311 0.094729933 0.561588</code></pre>
<p>实验结果表明，使用”Bonferroni”方法可以有效控制整体中出现一型错误的概率（FWER），这自然会使得一型错误率（FDR）被降到非常低，但是会以检验的功效（体现为真阳性率）为代价。而“B-H”方法在控制FDR的同时，没有使检验的效率降低太多，在不以降低FWER为首要目标的背景下是更为有效的方法。</p>
</div>
<div id="exercise-7.4" class="section level2">
<h2>Exercise 7.4</h2>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" tabindex="-1"></a><span class="fu">library</span>(boot)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;boot&#39;</code></pre>
<pre><code>## The following object is masked _by_ &#39;.GlobalEnv&#39;:
## 
##     tau</code></pre>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> aircondit<span class="sc">$</span>hours</span>
<span id="cb71-2"><a href="#cb71-2" tabindex="-1"></a>n <span class="ot">=</span> <span class="fu">length</span>(x)</span></code></pre></div>
<p>Denoting by <span class="math inline">\(x=(x_1,\dots,x_n)\)</span>
the data, the MLE of the hazard rate <span class="math inline">\(\lambda\)</span> is</p>
<p><span class="math display">\[
\hat{\lambda}_{MLE}=\frac{n}{\sum_{i=1}^n x_i}.
\]</span></p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb72-2"><a href="#cb72-2" tabindex="-1"></a>  <span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(x)</span>
<span id="cb72-3"><a href="#cb72-3" tabindex="-1"></a>}</span>
<span id="cb72-4"><a href="#cb72-4" tabindex="-1"></a></span>
<span id="cb72-5"><a href="#cb72-5" tabindex="-1"></a>theta.hat <span class="ot">=</span> <span class="fu">f</span>(x)</span></code></pre></div>
<p>Bootstrap:</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" tabindex="-1"></a>B <span class="ot">=</span> <span class="dv">50</span></span>
<span id="cb73-2"><a href="#cb73-2" tabindex="-1"></a>theta.boot <span class="ot">=</span> <span class="fu">numeric</span>(B)</span>
<span id="cb73-3"><a href="#cb73-3" tabindex="-1"></a></span>
<span id="cb73-4"><a href="#cb73-4" tabindex="-1"></a><span class="cf">for</span> (b <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B){</span>
<span id="cb73-5"><a href="#cb73-5" tabindex="-1"></a>  x.star <span class="ot">&lt;-</span> <span class="fu">sample</span>(x, <span class="at">size =</span> n, <span class="at">replace =</span> T)</span>
<span id="cb73-6"><a href="#cb73-6" tabindex="-1"></a>  theta.boot[b] <span class="ot">&lt;-</span> <span class="fu">f</span>(x.star)</span>
<span id="cb73-7"><a href="#cb73-7" tabindex="-1"></a>}</span>
<span id="cb73-8"><a href="#cb73-8" tabindex="-1"></a></span>
<span id="cb73-9"><a href="#cb73-9" tabindex="-1"></a>res <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">lambda.hat =</span> theta.hat,</span>
<span id="cb73-10"><a href="#cb73-10" tabindex="-1"></a>                 <span class="at">bias.estimated =</span> <span class="fu">mean</span>(theta.boot) <span class="sc">-</span> theta.hat,</span>
<span id="cb73-11"><a href="#cb73-11" tabindex="-1"></a>                 <span class="at">se.estimated =</span> <span class="fu">sd</span>(theta.boot), <span class="at">B =</span> B)</span>
<span id="cb73-12"><a href="#cb73-12" tabindex="-1"></a></span>
<span id="cb73-13"><a href="#cb73-13" tabindex="-1"></a><span class="fu">print</span>(res)</span></code></pre></div>
<pre><code>##   lambda.hat bias.estimated se.estimated  B
## 1 0.00925212   0.0009172563  0.004452179 50</code></pre>
</div>
<div id="exercise-7.5" class="section level2">
<h2>Exercise 7.5</h2>
<p>Compute 95% bootstrap confidence intervals for <span class="math inline">\(\frac{1}{\lambda}\)</span>, by the standard
normal, basic, percentile,and BCa methods.</p>
<p>The MLE estimator for <span class="math inline">\(\frac{1}{\lambda}\)</span> is the sample mean
<span class="math inline">\(\bar{x}\)</span>.</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" tabindex="-1"></a>theta.hat <span class="ot">=</span> <span class="fu">mean</span>(x)</span></code></pre></div>
<p>由于涉及估计置信区间，我们需要大一点的<span class="math inline">\(B=
2000\)</span>.</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" tabindex="-1"></a>stat.mean <span class="ot">=</span> <span class="cf">function</span>(x, i){</span>
<span id="cb76-2"><a href="#cb76-2" tabindex="-1"></a>  <span class="fu">mean</span>(x[i])</span>
<span id="cb76-3"><a href="#cb76-3" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" tabindex="-1"></a>m <span class="ot">=</span> <span class="dv">1000</span> <span class="do">## replications</span></span>
<span id="cb77-2"><a href="#cb77-2" tabindex="-1"></a>ci.norm<span class="ot">&lt;-</span>ci.basic<span class="ot">&lt;-</span>ci.perc<span class="ot">&lt;-</span>ci.bca<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="cn">NA</span>,m,<span class="dv">2</span>)</span>
<span id="cb77-3"><a href="#cb77-3" tabindex="-1"></a></span>
<span id="cb77-4"><a href="#cb77-4" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb77-5"><a href="#cb77-5" tabindex="-1"></a>  de <span class="ot">&lt;-</span> <span class="fu">boot</span>(x, <span class="at">statistic =</span> stat.mean, <span class="at">R =</span> <span class="dv">2000</span>)</span>
<span id="cb77-6"><a href="#cb77-6" tabindex="-1"></a>  ci <span class="ot">=</span> <span class="fu">boot.ci</span>(de, <span class="at">type=</span><span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>,<span class="st">&quot;bca&quot;</span>))</span>
<span id="cb77-7"><a href="#cb77-7" tabindex="-1"></a>  ci.norm[i,]<span class="ot">&lt;-</span>ci<span class="sc">$</span>norm[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>];    ci.basic[i,]<span class="ot">&lt;-</span>ci<span class="sc">$</span>basic[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb77-8"><a href="#cb77-8" tabindex="-1"></a>  ci.perc[i,]<span class="ot">&lt;-</span>ci<span class="sc">$</span>percent[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]; ci.bca[i,]<span class="ot">&lt;-</span>ci<span class="sc">$</span>bca[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb77-9"><a href="#cb77-9" tabindex="-1"></a>}</span></code></pre></div>
<p>得到置信区间：</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;norm:(&quot;</span>, <span class="fu">mean</span>(ci.norm[, <span class="dv">1</span>]), <span class="st">&quot;,&quot;</span>, <span class="fu">mean</span>(ci.norm[, <span class="dv">2</span>]), <span class="st">&quot;)</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## norm:( 34.37927 , 181.8496 )</code></pre>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;basic:(&quot;</span>, <span class="fu">mean</span>(ci.basic[, <span class="dv">1</span>]), <span class="st">&quot;,&quot;</span>, <span class="fu">mean</span>(ci.basic[, <span class="dv">2</span>]), <span class="st">&quot;)</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## basic:( 24.89505 , 169.4746 )</code></pre>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;percentile:(&quot;</span>, <span class="fu">mean</span>(ci.perc[, <span class="dv">1</span>]), <span class="st">&quot;,&quot;</span>, <span class="fu">mean</span>(ci.perc[, <span class="dv">2</span>]), <span class="st">&quot;)</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## percentile:( 46.69211 , 191.2716 )</code></pre>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;bca:(&quot;</span>, <span class="fu">mean</span>(ci.bca[, <span class="dv">1</span>]), <span class="st">&quot;,&quot;</span>, <span class="fu">mean</span>(ci.bca[, <span class="dv">2</span>]), <span class="st">&quot;)&quot;</span>)</span></code></pre></div>
<pre><code>## bca:( 56.94187 , 227.0512 )</code></pre>
<p>第一种norm的就不必多说，因为采用的模型正态，和下面三种非参数方法都不同；
basic和percentile的区间长度都是由resampling得到的<span class="math inline">\(\hat{\theta}^{*}\)</span>的经验分布得到的<span class="math inline">\((1-\alpha)\)</span>和<span class="math inline">\(\alpha\)</span>分位数之差，只是改变了中心位置。
最后bca对percentile的估计作了校正。</p>
</div>
<div id="exercise-7.8-jackknife-estimates" class="section level2">
<h2>Exercise 7.8 Jackknife Estimates</h2>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" tabindex="-1"></a><span class="fu">data</span>(scor, <span class="at">package =</span> <span class="st">&quot;bootstrap&quot;</span>)</span>
<span id="cb86-2"><a href="#cb86-2" tabindex="-1"></a>n <span class="ot">=</span> <span class="fu">nrow</span>(scor)</span>
<span id="cb86-3"><a href="#cb86-3" tabindex="-1"></a><span class="fu">pairs</span>(scor)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" tabindex="-1"></a>mcor <span class="ot">&lt;-</span> <span class="fu">cor</span>(scor)</span>
<span id="cb87-2"><a href="#cb87-2" tabindex="-1"></a><span class="fu">round</span>(mcor, <span class="at">digits =</span> <span class="dv">2</span>) <span class="do">## sample correlation</span></span></code></pre></div>
<pre><code>##      mec  vec  alg  ana  sta
## mec 1.00 0.55 0.55 0.41 0.39
## vec 0.55 1.00 0.61 0.49 0.44
## alg 0.55 0.61 1.00 0.71 0.66
## ana 0.41 0.49 0.71 1.00 0.61
## sta 0.39 0.44 0.66 0.61 1.00</code></pre>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" tabindex="-1"></a>theta <span class="ot">&lt;-</span> <span class="cf">function</span>(ind){</span>
<span id="cb89-2"><a href="#cb89-2" tabindex="-1"></a>  vals <span class="ot">&lt;-</span> <span class="fu">eigen</span>(<span class="fu">var</span>(scor[ind, ]), <span class="at">symmetric =</span> T,</span>
<span id="cb89-3"><a href="#cb89-3" tabindex="-1"></a>                <span class="at">only.values =</span> T)<span class="sc">$</span>values</span>
<span id="cb89-4"><a href="#cb89-4" tabindex="-1"></a>  vals[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(vals)</span>
<span id="cb89-5"><a href="#cb89-5" tabindex="-1"></a>}</span>
<span id="cb89-6"><a href="#cb89-6" tabindex="-1"></a>theta.hat <span class="ot">=</span> <span class="fu">theta</span>(<span class="dv">1</span><span class="sc">:</span>n)</span>
<span id="cb89-7"><a href="#cb89-7" tabindex="-1"></a><span class="fu">print</span>(theta.hat)</span></code></pre></div>
<pre><code>## [1] 0.619115</code></pre>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" tabindex="-1"></a><span class="co">#compute the jackknife replicates, leave-one-out estimates</span></span>
<span id="cb91-2"><a href="#cb91-2" tabindex="-1"></a>theta.jack <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb91-3"><a href="#cb91-3" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n)</span>
<span id="cb91-4"><a href="#cb91-4" tabindex="-1"></a>  theta.jack[i] <span class="ot">&lt;-</span> <span class="fu">theta</span>(<span class="sc">-</span>i)</span>
<span id="cb91-5"><a href="#cb91-5" tabindex="-1"></a><span class="co">#jackknife estimates of bias and standard error</span></span>
<span id="cb91-6"><a href="#cb91-6" tabindex="-1"></a>bias <span class="ot">&lt;-</span> (n <span class="sc">-</span> <span class="dv">1</span>)<span class="sc">*</span>(<span class="fu">mean</span>(theta.jack) <span class="sc">-</span> theta.hat)</span>
<span id="cb91-7"><a href="#cb91-7" tabindex="-1"></a><span class="fu">print</span>(bias)<span class="co">#jackknife estimate of bias</span></span></code></pre></div>
<pre><code>## [1] 0.001069139</code></pre>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" tabindex="-1"></a>sd <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((n <span class="sc">-</span> <span class="dv">1</span>)<span class="sc">*</span></span>
<span id="cb93-2"><a href="#cb93-2" tabindex="-1"></a>             <span class="fu">mean</span>((theta.jack <span class="sc">-</span> <span class="fu">mean</span>(theta.jack))<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb93-3"><a href="#cb93-3" tabindex="-1"></a><span class="fu">print</span>(sd)<span class="co">#jackknife estimate of standard error</span></span></code></pre></div>
<pre><code>## [1] 0.04955231</code></pre>
</div>
<div id="exercise-7.10-model-selection" class="section level2">
<h2>Exercise 7.10 Model Selection</h2>
<p>By replacing the <span class="math inline">\(Log\sim Log\)</span>
model <code>J4</code> with a cubic polynomial one, the procedure goes
like this:</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" tabindex="-1"></a><span class="fu">library</span>(DAAG); <span class="fu">attach</span>(ironslag)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;DAAG&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:MASS&#39;:
## 
##     hills</code></pre>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(magnetic)</span>
<span id="cb98-2"><a href="#cb98-2" tabindex="-1"></a>e1 <span class="ot">&lt;-</span> e2 <span class="ot">&lt;-</span> e3 <span class="ot">&lt;-</span> e4 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb98-3"><a href="#cb98-3" tabindex="-1"></a></span>
<span id="cb98-4"><a href="#cb98-4" tabindex="-1"></a><span class="co"># the four models</span></span>
<span id="cb98-5"><a href="#cb98-5" tabindex="-1"></a>L1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(magnetic <span class="sc">~</span> chemical)</span>
<span id="cb98-6"><a href="#cb98-6" tabindex="-1"></a>L2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(magnetic <span class="sc">~</span> chemical <span class="sc">+</span> <span class="fu">I</span>(chemical<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb98-7"><a href="#cb98-7" tabindex="-1"></a>L3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(magnetic) <span class="sc">~</span> chemical)</span>
<span id="cb98-8"><a href="#cb98-8" tabindex="-1"></a>L4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(magnetic <span class="sc">~</span> chemical <span class="sc">+</span> <span class="fu">I</span>(chemical<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(chemical<span class="sc">^</span><span class="dv">3</span>))</span>
<span id="cb98-9"><a href="#cb98-9" tabindex="-1"></a></span>
<span id="cb98-10"><a href="#cb98-10" tabindex="-1"></a><span class="co"># for n-fold cross validation</span></span>
<span id="cb98-11"><a href="#cb98-11" tabindex="-1"></a><span class="co"># fit models on leave-one-out samples</span></span>
<span id="cb98-12"><a href="#cb98-12" tabindex="-1"></a><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb98-13"><a href="#cb98-13" tabindex="-1"></a>  y <span class="ot">&lt;-</span> magnetic[<span class="sc">-</span>k]</span>
<span id="cb98-14"><a href="#cb98-14" tabindex="-1"></a>  x <span class="ot">&lt;-</span> chemical[<span class="sc">-</span>k]</span>
<span id="cb98-15"><a href="#cb98-15" tabindex="-1"></a>  <span class="do">## linear</span></span>
<span id="cb98-16"><a href="#cb98-16" tabindex="-1"></a>  J1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x)</span>
<span id="cb98-17"><a href="#cb98-17" tabindex="-1"></a>  yhat1 <span class="ot">&lt;-</span> J1<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J1<span class="sc">$</span>coef[<span class="dv">2</span>]<span class="sc">*</span>chemical[k]</span>
<span id="cb98-18"><a href="#cb98-18" tabindex="-1"></a>  e1[k] <span class="ot">&lt;-</span> magnetic[k] <span class="sc">-</span> yhat1</span>
<span id="cb98-19"><a href="#cb98-19" tabindex="-1"></a>  <span class="do">## quadratic</span></span>
<span id="cb98-20"><a href="#cb98-20" tabindex="-1"></a>  J2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb98-21"><a href="#cb98-21" tabindex="-1"></a>  yhat2 <span class="ot">&lt;-</span> J2<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J2<span class="sc">$</span>coef[<span class="dv">2</span>]<span class="sc">*</span>chemical[k] <span class="sc">+</span> </span>
<span id="cb98-22"><a href="#cb98-22" tabindex="-1"></a>    J2<span class="sc">$</span>coef[<span class="dv">3</span>]<span class="sc">*</span>chemical[k]<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb98-23"><a href="#cb98-23" tabindex="-1"></a>  e2[k] <span class="ot">&lt;-</span> magnetic[k] <span class="sc">-</span> yhat2</span>
<span id="cb98-24"><a href="#cb98-24" tabindex="-1"></a>  <span class="do">## log linear</span></span>
<span id="cb98-25"><a href="#cb98-25" tabindex="-1"></a>  J3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(y) <span class="sc">~</span> x)</span>
<span id="cb98-26"><a href="#cb98-26" tabindex="-1"></a>  logyhat3 <span class="ot">&lt;-</span> J3<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J3<span class="sc">$</span>coef[<span class="dv">2</span>]<span class="sc">*</span>chemical[k]</span>
<span id="cb98-27"><a href="#cb98-27" tabindex="-1"></a>  yhat3 <span class="ot">&lt;-</span> <span class="fu">exp</span>(logyhat3)</span>
<span id="cb98-28"><a href="#cb98-28" tabindex="-1"></a>  e3[k] <span class="ot">&lt;-</span> magnetic[k] <span class="sc">-</span> yhat3</span>
<span id="cb98-29"><a href="#cb98-29" tabindex="-1"></a>  <span class="do">## cubic</span></span>
<span id="cb98-30"><a href="#cb98-30" tabindex="-1"></a>  J4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">3</span>))</span>
<span id="cb98-31"><a href="#cb98-31" tabindex="-1"></a>  yhat4 <span class="ot">&lt;-</span> J4<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J4<span class="sc">$</span>coef[<span class="dv">2</span>]<span class="sc">*</span>chemical[k] <span class="sc">+</span> </span>
<span id="cb98-32"><a href="#cb98-32" tabindex="-1"></a>    J4<span class="sc">$</span>coef[<span class="dv">3</span>]<span class="sc">*</span>chemical[k]<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> J4<span class="sc">$</span>coef[<span class="dv">4</span>]<span class="sc">*</span>chemical[k]<span class="sc">^</span><span class="dv">3</span></span>
<span id="cb98-33"><a href="#cb98-33" tabindex="-1"></a>  e4[k] <span class="ot">&lt;-</span> magnetic[k] <span class="sc">-</span> yhat4</span>
<span id="cb98-34"><a href="#cb98-34" tabindex="-1"></a>}</span>
<span id="cb98-35"><a href="#cb98-35" tabindex="-1"></a><span class="fu">detach</span>(ironslag)</span></code></pre></div>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" tabindex="-1"></a><span class="co"># MSE</span></span>
<span id="cb99-2"><a href="#cb99-2" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">mean</span>(e1<span class="sc">^</span><span class="dv">2</span>), <span class="fu">mean</span>(e2<span class="sc">^</span><span class="dv">2</span>), <span class="fu">mean</span>(e3<span class="sc">^</span><span class="dv">2</span>), <span class="fu">mean</span>(e4<span class="sc">^</span><span class="dv">2</span>))</span></code></pre></div>
<pre><code>## [1] 19.55644 17.85248 18.44188 18.17756</code></pre>
<p>According to the prediction error criterion, the quadratic model
<code>L2</code> should be chosen as the best fit for the data.</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" tabindex="-1"></a><span class="co"># adjusted R squared</span></span>
<span id="cb101-2"><a href="#cb101-2" tabindex="-1"></a><span class="fu">summary</span>(L1)<span class="sc">$</span>adj.r.squared</span></code></pre></div>
<pre><code>## [1] 0.5281545</code></pre>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" tabindex="-1"></a><span class="fu">summary</span>(L2)<span class="sc">$</span>adj.r.squared</span></code></pre></div>
<pre><code>## [1] 0.5768151</code></pre>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" tabindex="-1"></a><span class="fu">summary</span>(L3)<span class="sc">$</span>adj.r.squared</span></code></pre></div>
<pre><code>## [1] 0.5280556</code></pre>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" tabindex="-1"></a><span class="fu">summary</span>(L4)<span class="sc">$</span>adj.r.squared</span></code></pre></div>
<pre><code>## [1] 0.5740396</code></pre>
<p>Under the adjusted-<span class="math inline">\(R^2\)</span>
criterion, still, <code>L2</code> is considered to be the best fit for
the data.</p>
</div>
<div id="exercise-8.1-two-sample-cramer-von-mises-for-univariate-data" class="section level2">
<h2>Exercise 8.1 two-sample Cram´er-von Mises for univariate data</h2>
<p>First we implement the algorithm:</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" tabindex="-1"></a>cramer_von_Mises.stat <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y){</span>
<span id="cb109-2"><a href="#cb109-2" tabindex="-1"></a>  n <span class="ot">=</span> <span class="fu">length</span>(x); m <span class="ot">=</span> <span class="fu">length</span>(y)</span>
<span id="cb109-3"><a href="#cb109-3" tabindex="-1"></a>  Fn <span class="ot">=</span> <span class="fu">ecdf</span>(x); Gm <span class="ot">=</span> <span class="fu">ecdf</span>(y)</span>
<span id="cb109-4"><a href="#cb109-4" tabindex="-1"></a>  z <span class="ot">=</span> <span class="fu">c</span>(x, y)</span>
<span id="cb109-5"><a href="#cb109-5" tabindex="-1"></a>  n<span class="sc">*</span>m<span class="sc">*</span><span class="fu">mean</span>((<span class="fu">Fn</span>(z) <span class="sc">-</span> <span class="fu">Gm</span>(z))<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>(n <span class="sc">+</span> m)</span>
<span id="cb109-6"><a href="#cb109-6" tabindex="-1"></a>}</span>
<span id="cb109-7"><a href="#cb109-7" tabindex="-1"></a></span>
<span id="cb109-8"><a href="#cb109-8" tabindex="-1"></a>perm.test <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, <span class="at">R =</span> <span class="dv">999</span>, test_stat){</span>
<span id="cb109-9"><a href="#cb109-9" tabindex="-1"></a>  z <span class="ot">&lt;-</span> <span class="fu">c</span>(x, y) <span class="co"># pooled sample</span></span>
<span id="cb109-10"><a href="#cb109-10" tabindex="-1"></a>  N <span class="ot">=</span> <span class="fu">length</span>(z)</span>
<span id="cb109-11"><a href="#cb109-11" tabindex="-1"></a>  n <span class="ot">=</span> <span class="fu">length</span>(x); m <span class="ot">=</span> N <span class="sc">-</span> n</span>
<span id="cb109-12"><a href="#cb109-12" tabindex="-1"></a>  K <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>N <span class="co"># indices for the pooled sample</span></span>
<span id="cb109-13"><a href="#cb109-13" tabindex="-1"></a>  W <span class="ot">&lt;-</span> <span class="fu">numeric</span>(R) <span class="co"># storage for replicates</span></span>
<span id="cb109-14"><a href="#cb109-14" tabindex="-1"></a>  </span>
<span id="cb109-15"><a href="#cb109-15" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>R){</span>
<span id="cb109-16"><a href="#cb109-16" tabindex="-1"></a>    <span class="co">#generate indices k for the first sample</span></span>
<span id="cb109-17"><a href="#cb109-17" tabindex="-1"></a>    k <span class="ot">&lt;-</span> <span class="fu">sample</span>(K, <span class="at">size =</span> n)</span>
<span id="cb109-18"><a href="#cb109-18" tabindex="-1"></a>    x1 <span class="ot">=</span> z[k]; y1 <span class="ot">=</span> z[<span class="sc">-</span>k]</span>
<span id="cb109-19"><a href="#cb109-19" tabindex="-1"></a>    W[i] <span class="ot">&lt;-</span> <span class="fu">test_stat</span>(x1, y1)</span>
<span id="cb109-20"><a href="#cb109-20" tabindex="-1"></a>  }</span>
<span id="cb109-21"><a href="#cb109-21" tabindex="-1"></a>  W0 <span class="ot">&lt;-</span> <span class="fu">test_stat</span>(x, y)</span>
<span id="cb109-22"><a href="#cb109-22" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">c</span>(W0, W) <span class="sc">&gt;=</span> W0)</span>
<span id="cb109-23"><a href="#cb109-23" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">W0 =</span> W0, <span class="at">W.perm =</span> W, <span class="at">p.value =</span> p))</span>
<span id="cb109-24"><a href="#cb109-24" tabindex="-1"></a>}</span></code></pre></div>
<p>Now we try our algorithm on data used in examples 8.1 and 8.2:</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" tabindex="-1"></a><span class="fu">attach</span>(chickwts)</span>
<span id="cb110-2"><a href="#cb110-2" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">as.vector</span>(weight[feed <span class="sc">==</span> <span class="st">&quot;soybean&quot;</span>]))</span>
<span id="cb110-3"><a href="#cb110-3" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">as.vector</span>(weight[feed <span class="sc">==</span> <span class="st">&quot;linseed&quot;</span>]))</span>
<span id="cb110-4"><a href="#cb110-4" tabindex="-1"></a><span class="fu">detach</span>(chickwts)</span>
<span id="cb110-5"><a href="#cb110-5" tabindex="-1"></a></span>
<span id="cb110-6"><a href="#cb110-6" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">perm.test</span>(x, y, <span class="dv">999</span>, cramer_von_Mises.stat)</span>
<span id="cb110-7"><a href="#cb110-7" tabindex="-1"></a></span>
<span id="cb110-8"><a href="#cb110-8" tabindex="-1"></a>res<span class="sc">$</span>p.value</span></code></pre></div>
<pre><code>## [1] 0.411</code></pre>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" tabindex="-1"></a><span class="fu">hist</span>(res<span class="sc">$</span>W.perm, <span class="at">freq =</span> <span class="cn">FALSE</span>, <span class="at">xlab =</span> <span class="st">&quot;test_stat_permuted&quot;</span>,</span>
<span id="cb112-2"><a href="#cb112-2" tabindex="-1"></a>     <span class="at">main =</span> <span class="cn">NULL</span>)</span>
<span id="cb112-3"><a href="#cb112-3" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> res<span class="sc">$</span>W0, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The result shows that the distributions of x and y are to much extent
alike, thus we prefer the null hypothesis.</p>
</div>
</div>
<div id="exercise-8.2-spearman-rank-correlation-test" class="section level1">
<h1>Exercise 8.2 Spearman rank correlation test</h1>
<p>We use <code>boot</code> function without replacements to obtain
replicates of test statistics. Data are the same as that in question
1.</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" tabindex="-1"></a><span class="fu">data</span>(scor, <span class="at">package =</span> <span class="st">&quot;bootstrap&quot;</span>)</span>
<span id="cb113-2"><a href="#cb113-2" tabindex="-1"></a>x <span class="ot">=</span> scor[, <span class="dv">3</span>]; y <span class="ot">=</span> scor[, <span class="dv">4</span>]</span>
<span id="cb113-3"><a href="#cb113-3" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">c</span>(x, y)</span>
<span id="cb113-4"><a href="#cb113-4" tabindex="-1"></a></span>
<span id="cb113-5"><a href="#cb113-5" tabindex="-1"></a>cor_bv <span class="ot">&lt;-</span> <span class="cf">function</span>(z, ix){</span>
<span id="cb113-6"><a href="#cb113-6" tabindex="-1"></a>  <span class="fu">stopifnot</span>(<span class="fu">length</span>(z) <span class="sc">%%</span> <span class="dv">2</span> <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb113-7"><a href="#cb113-7" tabindex="-1"></a>  n <span class="ot">=</span> <span class="fu">length</span>(z)<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb113-8"><a href="#cb113-8" tabindex="-1"></a>  z <span class="ot">&lt;-</span> z[ix]</span>
<span id="cb113-9"><a href="#cb113-9" tabindex="-1"></a>  <span class="fu">cor</span>(z[<span class="dv">1</span><span class="sc">:</span>n], z[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span>n)], <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb113-10"><a href="#cb113-10" tabindex="-1"></a>}</span>
<span id="cb113-11"><a href="#cb113-11" tabindex="-1"></a></span>
<span id="cb113-12"><a href="#cb113-12" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb113-13"><a href="#cb113-13" tabindex="-1"></a>boot.obj <span class="ot">&lt;-</span> <span class="fu">boot</span>(z, <span class="at">statistic =</span> cor_bv,</span>
<span id="cb113-14"><a href="#cb113-14" tabindex="-1"></a>                 <span class="at">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="at">R =</span> <span class="dv">999</span>)</span>
<span id="cb113-15"><a href="#cb113-15" tabindex="-1"></a></span>
<span id="cb113-16"><a href="#cb113-16" tabindex="-1"></a>boot.obj<span class="sc">$</span>t0 <span class="do">## original correlation</span></span></code></pre></div>
<pre><code>## [1] 0.7419719</code></pre>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" tabindex="-1"></a>tb <span class="ot">&lt;-</span> <span class="fu">c</span>(boot.obj<span class="sc">$</span>t, boot.obj<span class="sc">$</span>t0)</span>
<span id="cb115-2"><a href="#cb115-2" tabindex="-1"></a>p.value <span class="ot">&lt;-</span> <span class="fu">mean</span>(tb <span class="sc">&gt;=</span> boot.obj<span class="sc">$</span>t0)</span>
<span id="cb115-3"><a href="#cb115-3" tabindex="-1"></a>p.value</span></code></pre></div>
<pre><code>## [1] 0.001</code></pre>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" tabindex="-1"></a><span class="fu">hist</span>(boot.obj<span class="sc">$</span>t, <span class="at">freq =</span> <span class="cn">FALSE</span>, <span class="at">main =</span> <span class="st">&quot;&quot;</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb117-2"><a href="#cb117-2" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;replicates of Spearman correlations&quot;</span>)</span>
<span id="cb117-3"><a href="#cb117-3" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> boot.obj<span class="sc">$</span>t0, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Compare with <code>cor.test</code>:</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" tabindex="-1"></a><span class="fu">options</span>(<span class="at">warn =</span> <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb118-2"><a href="#cb118-2" tabindex="-1"></a><span class="fu">cor.test</span>(x, y, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span></code></pre></div>
<pre><code>## 
##  Spearman&#39;s rank correlation rho
## 
## data:  x and y
## S = 29303, p-value &lt; 2.2e-16
## alternative hypothesis: true rho is not equal to 0
## sample estimates:
##       rho 
## 0.7419719</code></pre>
<p>They are consistent.</p>
<div id="exercise-9.3-random-walk-metropolis" class="section level2">
<h2>Exercise 9.3 Random Walk Metropolis</h2>
<p>The goal is to generate a standard Cauchy Markov chain.</p>
<p>Set the proposal distribution <span class="math inline">\(g(Y|X_t)=\mathrm{N}(X_t,1)\)</span>:</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" tabindex="-1"></a><span class="do">## random walk Metropolis</span></span>
<span id="cb120-2"><a href="#cb120-2" tabindex="-1"></a>mcmc.rw <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">N =</span> <span class="dv">5000</span>, x0, <span class="at">f=</span>dcauchy, <span class="at">sigma =</span> <span class="dv">1</span>){</span>
<span id="cb120-3"><a href="#cb120-3" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb120-4"><a href="#cb120-4" tabindex="-1"></a>  x[<span class="dv">1</span>] <span class="ot">=</span> x0</span>
<span id="cb120-5"><a href="#cb120-5" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(N)</span>
<span id="cb120-6"><a href="#cb120-6" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb120-7"><a href="#cb120-7" tabindex="-1"></a>    xt <span class="ot">&lt;-</span> x[i<span class="dv">-1</span>]</span>
<span id="cb120-8"><a href="#cb120-8" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">sd =</span> sigma) <span class="sc">+</span> xt</span>
<span id="cb120-9"><a href="#cb120-9" tabindex="-1"></a>    num <span class="ot">=</span> <span class="fu">f</span>(y)</span>
<span id="cb120-10"><a href="#cb120-10" tabindex="-1"></a>    den <span class="ot">=</span> <span class="fu">f</span>(xt)</span>
<span id="cb120-11"><a href="#cb120-11" tabindex="-1"></a>    <span class="cf">if</span> (u[i] <span class="sc">&lt;=</span> num<span class="sc">/</span>den) x[i] <span class="ot">&lt;-</span> y</span>
<span id="cb120-12"><a href="#cb120-12" tabindex="-1"></a>    <span class="cf">else</span> x[i] <span class="ot">&lt;-</span> xt</span>
<span id="cb120-13"><a href="#cb120-13" tabindex="-1"></a>  }</span>
<span id="cb120-14"><a href="#cb120-14" tabindex="-1"></a>  <span class="fu">return</span>(x)</span>
<span id="cb120-15"><a href="#cb120-15" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">5000</span></span>
<span id="cb121-2"><a href="#cb121-2" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb121-3"><a href="#cb121-3" tabindex="-1"></a></span>
<span id="cb121-4"><a href="#cb121-4" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">mcmc.rw</span>(N, <span class="at">x0 =</span> <span class="fu">rcauchy</span>(<span class="dv">1</span>), <span class="at">f =</span> dcauchy)</span>
<span id="cb121-5"><a href="#cb121-5" tabindex="-1"></a>x <span class="ot">=</span> x[(b <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>N]</span>
<span id="cb121-6"><a href="#cb121-6" tabindex="-1"></a></span>
<span id="cb121-7"><a href="#cb121-7" tabindex="-1"></a><span class="fu">plot</span>((b <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>N, <span class="at">y =</span> x, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">main =</span> <span class="st">&quot;&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;t&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;X&quot;</span>)</span>
<span id="cb121-8"><a href="#cb121-8" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">&quot;green&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Compare the deciles of generated samples with theoretical ones:</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" tabindex="-1"></a><span class="fu">quantile</span>(x, <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.75</span>))</span></code></pre></div>
<pre><code>##        25%        75% 
## -0.7467715  0.9010549</code></pre>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" tabindex="-1"></a><span class="fu">qcauchy</span>(<span class="at">p =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.75</span>))</span></code></pre></div>
<pre><code>## [1] -1  1</code></pre>
<p>Sometimes they are close and sometimes not, it depends.</p>
</div>
<div id="exercise-9.8-gibbs-sampler" class="section level2">
<h2>Exercise 9.8 Gibbs Sampler</h2>
<p>Under the condition that <span class="math inline">\(a, b, n\)</span>
are fixed, we have</p>
<p><span class="math display">\[
X|Y\sim \text{Binomial}(n,y),~~Y|X\sim\text{Beta}(x+a,n-x+b),
\]</span></p>
<p>where <span class="math inline">\(x=0,1,\dots,n\)</span>, <span class="math inline">\(0\le y\le1\)</span>.</p>
<p>Use Gibbs sampler to generate a chain that has joint density <span class="math inline">\(f(x, y)\)</span>.</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" tabindex="-1"></a>Gibbs <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">N =</span> <span class="dv">5000</span>, <span class="at">x0 =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb126-2"><a href="#cb126-2" tabindex="-1"></a>                  <span class="at">a =</span> <span class="dv">1</span>, <span class="at">b =</span> <span class="dv">1</span>, <span class="at">n =</span> <span class="dv">100</span>) {</span>
<span id="cb126-3"><a href="#cb126-3" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, N, <span class="dv">2</span>) <span class="co"># the chain, a bivariate sample</span></span>
<span id="cb126-4"><a href="#cb126-4" tabindex="-1"></a>  X[<span class="dv">1</span>, ] <span class="ot">=</span> x0          <span class="co"># initialize</span></span>
<span id="cb126-5"><a href="#cb126-5" tabindex="-1"></a>  </span>
<span id="cb126-6"><a href="#cb126-6" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N){</span>
<span id="cb126-7"><a href="#cb126-7" tabindex="-1"></a>    y <span class="ot">&lt;-</span> X[i<span class="dv">-1</span>, <span class="dv">2</span>]</span>
<span id="cb126-8"><a href="#cb126-8" tabindex="-1"></a>    X[i, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, n, y)</span>
<span id="cb126-9"><a href="#cb126-9" tabindex="-1"></a>    x <span class="ot">&lt;-</span> X[i<span class="dv">-1</span>, <span class="dv">1</span>]</span>
<span id="cb126-10"><a href="#cb126-10" tabindex="-1"></a>    X[i, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>, x <span class="sc">+</span> a, n <span class="sc">-</span> x <span class="sc">+</span> b)</span>
<span id="cb126-11"><a href="#cb126-11" tabindex="-1"></a>  }</span>
<span id="cb126-12"><a href="#cb126-12" tabindex="-1"></a>  <span class="fu">return</span>(X)</span>
<span id="cb126-13"><a href="#cb126-13" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">5000</span>            <span class="co"># the length of chain</span></span>
<span id="cb127-2"><a href="#cb127-2" tabindex="-1"></a>burn <span class="ot">&lt;-</span> <span class="dv">1000</span>         <span class="co"># the burn-in length</span></span>
<span id="cb127-3"><a href="#cb127-3" tabindex="-1"></a></span>
<span id="cb127-4"><a href="#cb127-4" tabindex="-1"></a><span class="do">####set parameters####</span></span>
<span id="cb127-5"><a href="#cb127-5" tabindex="-1"></a>a <span class="ot">&lt;-</span> b <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb127-6"><a href="#cb127-6" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">100</span></span>
<span id="cb127-7"><a href="#cb127-7" tabindex="-1"></a></span>
<span id="cb127-8"><a href="#cb127-8" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">Gibbs</span>(N, <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>), a, b, n)</span>
<span id="cb127-9"><a href="#cb127-9" tabindex="-1"></a>X <span class="ot">&lt;-</span> X[(burn <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>N, ]</span></code></pre></div>
</div>
<div id="gelman-rubin-method" class="section level2">
<h2>Gelman-Rubin Method</h2>
<p>We generate <span class="math inline">\(m\)</span> chains, and we use
<span class="math inline">\(\psi_{ij}\)</span> to denote the statistic
<span class="math inline">\(\psi(X^{(i)}_{1},\dots,
X^{(i)}_{j})\)</span> for the <span class="math inline">\(i-th\)</span>
chain.</p>
<div id="exercise-9.3" class="section level4">
<h4>exercise 9.3</h4>
<p>Choose mean as the diagnostic statistics <span class="math inline">\(\psi\)</span>.</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" tabindex="-1"></a>Gelman.Rubin <span class="ot">&lt;-</span> <span class="cf">function</span>(psi) {</span>
<span id="cb128-2"><a href="#cb128-2" tabindex="-1"></a>  <span class="co"># psi[i,j] is the statistic psi(X[i,1:j]) for chain in i-th row of X</span></span>
<span id="cb128-3"><a href="#cb128-3" tabindex="-1"></a>  psi <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(psi)</span>
<span id="cb128-4"><a href="#cb128-4" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">ncol</span>(psi)</span>
<span id="cb128-5"><a href="#cb128-5" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="fu">nrow</span>(psi)</span>
<span id="cb128-6"><a href="#cb128-6" tabindex="-1"></a>  psi.means <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(psi)     <span class="co">#row means</span></span>
<span id="cb128-7"><a href="#cb128-7" tabindex="-1"></a>  B <span class="ot">&lt;-</span> n <span class="sc">*</span> <span class="fu">var</span>(psi.means)        <span class="co">#between variance est.</span></span>
<span id="cb128-8"><a href="#cb128-8" tabindex="-1"></a>  psi.w <span class="ot">&lt;-</span> <span class="fu">apply</span>(psi, <span class="dv">1</span>, <span class="st">&quot;var&quot;</span>)  <span class="co">#within variances</span></span>
<span id="cb128-9"><a href="#cb128-9" tabindex="-1"></a>  W <span class="ot">&lt;-</span> <span class="fu">mean</span>(psi.w)               <span class="co">#within est. </span></span>
<span id="cb128-10"><a href="#cb128-10" tabindex="-1"></a>  v.hat <span class="ot">&lt;-</span> W<span class="sc">*</span>(n<span class="dv">-1</span>)<span class="sc">/</span>n <span class="sc">+</span> (B<span class="sc">/</span>n)     <span class="co">#upper variance est.</span></span>
<span id="cb128-11"><a href="#cb128-11" tabindex="-1"></a>  r.hat <span class="ot">&lt;-</span> v.hat <span class="sc">/</span> W             <span class="co">#G-R statistic</span></span>
<span id="cb128-12"><a href="#cb128-12" tabindex="-1"></a>  <span class="fu">return</span>(r.hat)</span>
<span id="cb128-13"><a href="#cb128-13" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" tabindex="-1"></a>m <span class="ot">=</span> <span class="dv">4</span></span>
<span id="cb129-2"><a href="#cb129-2" tabindex="-1"></a>N <span class="ot">=</span> <span class="dv">25000</span></span>
<span id="cb129-3"><a href="#cb129-3" tabindex="-1"></a>burn <span class="ot">=</span> <span class="dv">1000</span></span>
<span id="cb129-4"><a href="#cb129-4" tabindex="-1"></a></span>
<span id="cb129-5"><a href="#cb129-5" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="at">dim =</span> <span class="fu">c</span>(m, N))</span>
<span id="cb129-6"><a href="#cb129-6" tabindex="-1"></a></span>
<span id="cb129-7"><a href="#cb129-7" tabindex="-1"></a><span class="co">#choose overdispersed initial values</span></span>
<span id="cb129-8"><a href="#cb129-8" tabindex="-1"></a>x0 <span class="ot">=</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>, <span class="sc">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">10</span>)</span>
<span id="cb129-9"><a href="#cb129-9" tabindex="-1"></a></span>
<span id="cb129-10"><a href="#cb129-10" tabindex="-1"></a><span class="do">####generating chains####</span></span>
<span id="cb129-11"><a href="#cb129-11" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb129-12"><a href="#cb129-12" tabindex="-1"></a>  X[i, ] <span class="ot">&lt;-</span> <span class="fu">mcmc.rw</span>(N, x0[i])</span>
<span id="cb129-13"><a href="#cb129-13" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" tabindex="-1"></a><span class="co">#compute diagnostic statistics</span></span>
<span id="cb130-2"><a href="#cb130-2" tabindex="-1"></a>psi <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(X, <span class="dv">1</span>, cumsum))</span>
<span id="cb130-3"><a href="#cb130-3" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(psi))</span>
<span id="cb130-4"><a href="#cb130-4" tabindex="-1"></a>  psi[i, ] <span class="ot">&lt;-</span> psi[i, ] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psi))</span>
<span id="cb130-5"><a href="#cb130-5" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">Gelman.Rubin</span>(psi))</span></code></pre></div>
<pre><code>## [1] 1.398301</code></pre>
<p>Plot <span class="math inline">\(\psi\)</span> for <span class="math inline">\(4\)</span> chains:</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb132-2"><a href="#cb132-2" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb132-3"><a href="#cb132-3" tabindex="-1"></a>  <span class="fu">plot</span>(psi[i, (burn <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>N], <span class="at">type =</span> <span class="st">&quot;l&quot;</span>,</span>
<span id="cb132-4"><a href="#cb132-4" tabindex="-1"></a>       <span class="at">xlab =</span> i, <span class="at">ylab =</span> <span class="fu">bquote</span>(psi))</span>
<span id="cb132-5"><a href="#cb132-5" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Plot the sequence of <span class="math inline">\(\hat{R}\)</span>
statistics:</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb133-2"><a href="#cb133-2" tabindex="-1"></a>R.hat <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, N)</span>
<span id="cb133-3"><a href="#cb133-3" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> (burn <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>N){</span>
<span id="cb133-4"><a href="#cb133-4" tabindex="-1"></a>  R.hat[j] <span class="ot">&lt;-</span> <span class="fu">Gelman.Rubin</span>(psi[, <span class="dv">1</span><span class="sc">:</span>j])</span>
<span id="cb133-5"><a href="#cb133-5" tabindex="-1"></a>}</span>
<span id="cb133-6"><a href="#cb133-6" tabindex="-1"></a><span class="fu">plot</span>(R.hat[(burn <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>N], <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">3.5</span>),</span>
<span id="cb133-7"><a href="#cb133-7" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;R&quot;</span>)</span>
<span id="cb133-8"><a href="#cb133-8" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="fl">1.2</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Target distribution is Cauchy, whose variance is infinity, and
proposal distribution is normal distribution, with <span class="math inline">\(\sigma=1\)</span>. This has caused a slow
convergence, as it can be seen from the figure above.</p>
</div>
<div id="exercise-9.8" class="section level4">
<h4>Exercise 9.8</h4>
<p>The original article by Gelman &amp; Rubin, as well as the Bayesian
Data Analysis textbook of Gelman et al., recommends calculating the
<strong>potential scale reduction factor (PSRF)</strong>
<em>separately</em> for each scalar parameter of interest. To deduce
convergence, it is then required that all PSRFs are close to 1.</p>
<p>Still we choose mean as the diagnostic statistics <span class="math inline">\(\psi\)</span>.</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" tabindex="-1"></a>m <span class="ot">=</span> <span class="dv">4</span></span>
<span id="cb134-2"><a href="#cb134-2" tabindex="-1"></a>N <span class="ot">=</span> <span class="dv">25000</span></span>
<span id="cb134-3"><a href="#cb134-3" tabindex="-1"></a>burn <span class="ot">=</span> <span class="dv">1000</span></span>
<span id="cb134-4"><a href="#cb134-4" tabindex="-1"></a></span>
<span id="cb134-5"><a href="#cb134-5" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="dv">0</span>, <span class="at">dim =</span> <span class="fu">c</span>(m, N, <span class="dv">2</span>))</span>
<span id="cb134-6"><a href="#cb134-6" tabindex="-1"></a></span>
<span id="cb134-7"><a href="#cb134-7" tabindex="-1"></a><span class="co">#choose overdispersed initial values</span></span>
<span id="cb134-8"><a href="#cb134-8" tabindex="-1"></a>x0 <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">0</span>,  <span class="dv">25</span>, <span class="dv">50</span>,  <span class="dv">75</span>,</span>
<span id="cb134-9"><a href="#cb134-9" tabindex="-1"></a>              <span class="dv">0</span>, .<span class="dv">25</span>, .<span class="dv">5</span>, .<span class="dv">75</span>), <span class="dv">4</span>, <span class="dv">2</span>)</span>
<span id="cb134-10"><a href="#cb134-10" tabindex="-1"></a></span>
<span id="cb134-11"><a href="#cb134-11" tabindex="-1"></a>a <span class="ot">&lt;-</span> b <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb134-12"><a href="#cb134-12" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">100</span></span>
<span id="cb134-13"><a href="#cb134-13" tabindex="-1"></a></span>
<span id="cb134-14"><a href="#cb134-14" tabindex="-1"></a><span class="do">####generating chains####</span></span>
<span id="cb134-15"><a href="#cb134-15" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb134-16"><a href="#cb134-16" tabindex="-1"></a>  X[i, , ] <span class="ot">&lt;-</span> <span class="fu">Gibbs</span>(N, x0[i, ])</span>
<span id="cb134-17"><a href="#cb134-17" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" tabindex="-1"></a><span class="co">#compute diagnostic statistics for Xt and Yt respectively</span></span>
<span id="cb135-2"><a href="#cb135-2" tabindex="-1"></a>psi.x <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(X[, , <span class="dv">1</span>], <span class="dv">1</span>, cumsum))</span>
<span id="cb135-3"><a href="#cb135-3" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(psi.x))</span>
<span id="cb135-4"><a href="#cb135-4" tabindex="-1"></a>  psi.x[i, ] <span class="ot">&lt;-</span> psi.x[i, ] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psi.x))</span>
<span id="cb135-5"><a href="#cb135-5" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">Gelman.Rubin</span>(psi.x))</span></code></pre></div>
<pre><code>## [1] 1.60149</code></pre>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" tabindex="-1"></a>psi.y <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(X[, , <span class="dv">2</span>], <span class="dv">1</span>, cumsum))</span>
<span id="cb137-2"><a href="#cb137-2" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(psi.y))</span>
<span id="cb137-3"><a href="#cb137-3" tabindex="-1"></a>  psi.y[i, ] <span class="ot">&lt;-</span> psi.y[i, ] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psi.y))</span>
<span id="cb137-4"><a href="#cb137-4" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">Gelman.Rubin</span>(psi.y))</span></code></pre></div>
<pre><code>## [1] 1.595275</code></pre>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb139-2"><a href="#cb139-2" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb139-3"><a href="#cb139-3" tabindex="-1"></a>  <span class="fu">plot</span>(psi.x[i, (burn <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>N], <span class="at">type =</span> <span class="st">&quot;l&quot;</span>,</span>
<span id="cb139-4"><a href="#cb139-4" tabindex="-1"></a>       <span class="at">xlab =</span> i, <span class="at">ylab =</span> <span class="st">&quot;psi.x&quot;</span>)</span>
<span id="cb139-5"><a href="#cb139-5" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb140-2"><a href="#cb140-2" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb140-3"><a href="#cb140-3" tabindex="-1"></a>  <span class="fu">plot</span>(psi.y[i, (burn <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>N], <span class="at">type =</span> <span class="st">&quot;l&quot;</span>,</span>
<span id="cb140-4"><a href="#cb140-4" tabindex="-1"></a>       <span class="at">xlab =</span> i, <span class="at">ylab =</span> <span class="st">&quot;psi.y&quot;</span>)</span>
<span id="cb140-5"><a href="#cb140-5" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Plot the sequence of <span class="math inline">\(\hat{R}\)</span>
statistics for <span class="math inline">\(X_t\)</span> and <span class="math inline">\(Y_t\)</span> separately:</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb141-2"><a href="#cb141-2" tabindex="-1"></a>R.hat.x <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, N)</span>
<span id="cb141-3"><a href="#cb141-3" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> (burn <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>N){</span>
<span id="cb141-4"><a href="#cb141-4" tabindex="-1"></a>  R.hat.x[j] <span class="ot">&lt;-</span> <span class="fu">Gelman.Rubin</span>(psi.x[, <span class="dv">1</span><span class="sc">:</span>j])</span>
<span id="cb141-5"><a href="#cb141-5" tabindex="-1"></a>}</span>
<span id="cb141-6"><a href="#cb141-6" tabindex="-1"></a><span class="fu">plot</span>(R.hat.x[(burn <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>N], <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">3.5</span>),</span>
<span id="cb141-7"><a href="#cb141-7" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;R of Xt&quot;</span>)</span>
<span id="cb141-8"><a href="#cb141-8" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="fl">1.2</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb142-2"><a href="#cb142-2" tabindex="-1"></a>R.hat.y <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, N)</span>
<span id="cb142-3"><a href="#cb142-3" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> (burn <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>N){</span>
<span id="cb142-4"><a href="#cb142-4" tabindex="-1"></a>  R.hat.y[j] <span class="ot">&lt;-</span> <span class="fu">Gelman.Rubin</span>(psi.y[, <span class="dv">1</span><span class="sc">:</span>j])</span>
<span id="cb142-5"><a href="#cb142-5" tabindex="-1"></a>}</span>
<span id="cb142-6"><a href="#cb142-6" tabindex="-1"></a><span class="fu">plot</span>(R.hat.y[(burn <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>N], <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">3.5</span>),</span>
<span id="cb142-7"><a href="#cb142-7" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;R of Yt&quot;</span>)</span>
<span id="cb142-8"><a href="#cb142-8" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="fl">1.2</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Fortunately, these sequences do converge, satisfying <span class="math inline">\(\hat R &lt; 1.2\)</span> at around N = 10000.</p>
</div>
</div>
<div id="exercise-11.3" class="section level2">
<h2>Exercise 11.3</h2>
<p>Write a function to compute</p>
<p><span class="math display">\[
\sum_{k = 0}^{\infty}\frac{(-1)^k}{k!2^k}\frac{\|a\|^{2k + 2}}{(2k +
1)(2k + 2)}\frac{\Gamma(\frac{d+1}{2})\Gamma(k+\frac32)}{\Gamma(k +
\frac{d}{2} + 1)}.
\]</span></p>
<div id="k-th-coefficient" class="section level4">
<h4><span class="math inline">\(k\)</span>-th coefficient</h4>
<p>While computing, use exponential to avoid producing
<code>NaN</code>s:</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" tabindex="-1"></a>fk <span class="ot">&lt;-</span> <span class="cf">function</span>(k, a, d){</span>
<span id="cb143-2"><a href="#cb143-2" tabindex="-1"></a>  <span class="fu">stopifnot</span>(d <span class="sc">&gt;=</span> <span class="dv">1</span> <span class="sc">&amp;&amp;</span> <span class="fu">length</span>(a) <span class="sc">==</span> d)</span>
<span id="cb143-3"><a href="#cb143-3" tabindex="-1"></a>  A <span class="ot">=</span> <span class="fu">log</span>(<span class="fu">sum</span>(a<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb143-4"><a href="#cb143-4" tabindex="-1"></a>  </span>
<span id="cb143-5"><a href="#cb143-5" tabindex="-1"></a>  signk <span class="ot">=</span> (k <span class="sc">%%</span> <span class="dv">2</span> <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb143-6"><a href="#cb143-6" tabindex="-1"></a>  </span>
<span id="cb143-7"><a href="#cb143-7" tabindex="-1"></a>  signk<span class="sc">*</span><span class="fu">exp</span>((k <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">*</span>A <span class="sc">+</span> <span class="fu">lgamma</span>((d <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">lgamma</span>(k <span class="sc">+</span> <span class="dv">3</span><span class="sc">/</span><span class="dv">2</span>) <span class="sc">-</span> <span class="fu">lgamma</span>(k <span class="sc">+</span> d<span class="sc">/</span><span class="dv">2</span> <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">-</span> <span class="fu">lgamma</span>(k <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">-</span> k<span class="sc">*</span><span class="fu">log</span>(<span class="dv">2</span>))<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>k <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>k <span class="sc">+</span> <span class="dv">2</span>)</span>
<span id="cb143-8"><a href="#cb143-8" tabindex="-1"></a>}</span>
<span id="cb143-9"><a href="#cb143-9" tabindex="-1"></a></span>
<span id="cb143-10"><a href="#cb143-10" tabindex="-1"></a><span class="fu">fk</span>(<span class="dv">20</span>, <span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">10</span>), <span class="dv">10</span>)</span></code></pre></div>
<pre><code>## [1] 8.513396e-12</code></pre>
</div>
<div id="sum" class="section level4">
<h4>Sum</h4>
<p>Use vectors instead of loops to compute the sum:</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" tabindex="-1"></a>Sk <span class="ot">&lt;-</span> <span class="cf">function</span>(k, a, d){</span>
<span id="cb145-2"><a href="#cb145-2" tabindex="-1"></a>  <span class="fu">stopifnot</span>(d <span class="sc">&gt;=</span> <span class="dv">1</span> <span class="sc">&amp;&amp;</span> <span class="fu">length</span>(a) <span class="sc">==</span> d)</span>
<span id="cb145-3"><a href="#cb145-3" tabindex="-1"></a>  A <span class="ot">=</span> <span class="fu">log</span>(<span class="fu">sum</span>(a<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb145-4"><a href="#cb145-4" tabindex="-1"></a>  </span>
<span id="cb145-5"><a href="#cb145-5" tabindex="-1"></a>  K <span class="ot">=</span> <span class="dv">0</span><span class="sc">:</span>k</span>
<span id="cb145-6"><a href="#cb145-6" tabindex="-1"></a>  signk <span class="ot">=</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>), (k <span class="sc">+</span> <span class="dv">2</span>) <span class="sc">%/%</span> <span class="dv">2</span>)</span>
<span id="cb145-7"><a href="#cb145-7" tabindex="-1"></a>  signk <span class="ot">=</span> signk[<span class="dv">1</span><span class="sc">:</span>(k <span class="sc">+</span> <span class="dv">1</span>)]</span>
<span id="cb145-8"><a href="#cb145-8" tabindex="-1"></a>  <span class="fu">sum</span>(signk<span class="sc">*</span><span class="fu">exp</span>((K <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">*</span>A <span class="sc">+</span> <span class="fu">lgamma</span>(d<span class="sc">/</span><span class="dv">2</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">lgamma</span>(K <span class="sc">+</span> <span class="dv">3</span><span class="sc">/</span><span class="dv">2</span>) <span class="sc">-</span> </span>
<span id="cb145-9"><a href="#cb145-9" tabindex="-1"></a>                  <span class="fu">lgamma</span>(K <span class="sc">+</span> d<span class="sc">/</span><span class="dv">2</span> <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">-</span> <span class="fu">lgamma</span>(K <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">-</span> K<span class="sc">*</span><span class="fu">log</span>(<span class="dv">2</span>))<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>K <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>K <span class="sc">+</span> <span class="dv">2</span>))</span>
<span id="cb145-10"><a href="#cb145-10" tabindex="-1"></a>}</span>
<span id="cb145-11"><a href="#cb145-11" tabindex="-1"></a></span>
<span id="cb145-12"><a href="#cb145-12" tabindex="-1"></a><span class="fu">Sk</span>(<span class="dv">20</span>, <span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">10</span>), <span class="dv">10</span>)</span></code></pre></div>
<pre><code>## [1] 1.633613</code></pre>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" tabindex="-1"></a><span class="fu">Sk</span>(<span class="dv">20</span>, <span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">10</span>), <span class="dv">10</span>) <span class="sc">-</span> <span class="fu">Sk</span>(<span class="dv">19</span>, <span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">10</span>), <span class="dv">10</span>)</span></code></pre></div>
<pre><code>## [1] 8.513412e-12</code></pre>
</div>
<div id="evaluation" class="section level4">
<h4>Evaluation</h4>
<p>When <span class="math inline">\(a=c(1,2)^T\)</span>,</p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" tabindex="-1"></a>a <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>); d <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb149-2"><a href="#cb149-2" tabindex="-1"></a>K <span class="ot">=</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">15</span></span>
<span id="cb149-3"><a href="#cb149-3" tabindex="-1"></a>S <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(K))</span>
<span id="cb149-4"><a href="#cb149-4" tabindex="-1"></a></span>
<span id="cb149-5"><a href="#cb149-5" tabindex="-1"></a><span class="cf">for</span> (k <span class="cf">in</span> K){</span>
<span id="cb149-6"><a href="#cb149-6" tabindex="-1"></a>  S[k <span class="sc">+</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">Sk</span>(k, a, d)</span>
<span id="cb149-7"><a href="#cb149-7" tabindex="-1"></a>}</span>
<span id="cb149-8"><a href="#cb149-8" tabindex="-1"></a></span>
<span id="cb149-9"><a href="#cb149-9" tabindex="-1"></a>data <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">k =</span> K, <span class="at">sum =</span> S)</span>
<span id="cb149-10"><a href="#cb149-10" tabindex="-1"></a></span>
<span id="cb149-11"><a href="#cb149-11" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(data, <span class="at">align =</span> <span class="fu">c</span>(<span class="st">&quot;c&quot;</span>, <span class="st">&quot;c&quot;</span>))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="center">k</th>
<th align="center">sum</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">0</td>
<td align="center">1.963495</td>
</tr>
<tr class="even">
<td align="center">1</td>
<td align="center">1.349903</td>
</tr>
<tr class="odd">
<td align="center">2</td>
<td align="center">1.605567</td>
</tr>
<tr class="even">
<td align="center">3</td>
<td align="center">1.505698</td>
</tr>
<tr class="odd">
<td align="center">4</td>
<td align="center">1.540652</td>
</tr>
<tr class="even">
<td align="center">5</td>
<td align="center">1.529729</td>
</tr>
<tr class="odd">
<td align="center">6</td>
<td align="center">1.532794</td>
</tr>
<tr class="even">
<td align="center">7</td>
<td align="center">1.532016</td>
</tr>
<tr class="odd">
<td align="center">8</td>
<td align="center">1.532196</td>
</tr>
<tr class="even">
<td align="center">9</td>
<td align="center">1.532158</td>
</tr>
<tr class="odd">
<td align="center">10</td>
<td align="center">1.532165</td>
</tr>
<tr class="even">
<td align="center">11</td>
<td align="center">1.532164</td>
</tr>
<tr class="odd">
<td align="center">12</td>
<td align="center">1.532164</td>
</tr>
<tr class="even">
<td align="center">13</td>
<td align="center">1.532164</td>
</tr>
<tr class="odd">
<td align="center">14</td>
<td align="center">1.532164</td>
</tr>
<tr class="even">
<td align="center">15</td>
<td align="center">1.532164</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" tabindex="-1"></a><span class="fu">plot</span>(data, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="exercise-11.5" class="section level2">
<h2>Exercise 11.5</h2>
<p>Write a function to solve the equation</p>
<p><span class="math display">\[
\begin{align}
\frac{2\Gamma(\frac k
2)}{\sqrt{\pi(k-1)}\Gamma(\frac{k-1}2)}\int_{0}^{c_{k-1}}(1+\frac{u^2}{k-1})^{-k/2}\mathrm{d}u\\
=\frac{2\Gamma(\frac {k+1}2)}{\sqrt{\pi k}\Gamma(\frac
k2)}\int_0^{c_k}(1+\frac{u^2}k)^{-(k+ 1)/2}\mathrm d u,
\end{align}
\]</span></p>
<p>for <span class="math inline">\(a\)</span>, where <span class="math inline">\(k\in \mathbb{N}^*\)</span> and</p>
<p><span class="math display">\[
c_k = \sqrt{\frac{a^2k}{k + 1-a^2}}.
\]</span></p>
<p>Obviously the equation is in the form of</p>
<p><span class="math display">\[
f_{k-1}(a)=f_{k}(a)
\]</span></p>
<p>where</p>
<p><span class="math display">\[
f_k(a) = \frac{2\Gamma(\frac {k+1}2)}{\sqrt{\pi k}\Gamma(\frac
k2)}\int_0^{c_k}(1+\frac{u^2}k)^{-(k+ 1)/2}\mathrm d u = \mathrm{Pr}(|
t(k) |\le c_k) = 1-2S_k(a),
\]</span></p>
<p>where <span class="math inline">\(t(k)\)</span> is a random variable
from Student t distribution with degree of freedom <span class="math inline">\(k\)</span>. Thus the solution to the equation here
is exactly the intersection point <span class="math inline">\(A(k)\)</span> of curves <span class="math inline">\(S_{k-1}(a)\)</span> and <span class="math inline">\(S_k(a)\)</span> in exercise 11.4.</p>
<p>Write a function to compute <span class="math inline">\(f_k(a)\)</span>:</p>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(k, a){</span>
<span id="cb151-2"><a href="#cb151-2" tabindex="-1"></a>  <span class="fu">stopifnot</span>(k <span class="sc">+</span> <span class="dv">1</span> <span class="sc">-</span> a<span class="sc">^</span><span class="dv">2</span> <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb151-3"><a href="#cb151-3" tabindex="-1"></a>  ck <span class="ot">=</span> <span class="fu">sqrt</span>(a<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>k<span class="sc">/</span>(k<span class="sc">+</span><span class="dv">1</span><span class="sc">-</span>a<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb151-4"><a href="#cb151-4" tabindex="-1"></a>  </span>
<span id="cb151-5"><a href="#cb151-5" tabindex="-1"></a>  b <span class="ot">=</span> <span class="dv">2</span><span class="sc">/</span><span class="fu">sqrt</span>(pi<span class="sc">*</span>k)<span class="sc">*</span><span class="fu">exp</span>(<span class="fu">lgamma</span>((k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>)<span class="sc">-</span><span class="fu">lgamma</span>(k<span class="sc">/</span><span class="dv">2</span>))</span>
<span id="cb151-6"><a href="#cb151-6" tabindex="-1"></a>  </span>
<span id="cb151-7"><a href="#cb151-7" tabindex="-1"></a>  integrand <span class="ot">&lt;-</span> <span class="cf">function</span>(u){</span>
<span id="cb151-8"><a href="#cb151-8" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">+</span> u<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>k)<span class="sc">^</span>{<span class="sc">-</span>(k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>}</span>
<span id="cb151-9"><a href="#cb151-9" tabindex="-1"></a>  }</span>
<span id="cb151-10"><a href="#cb151-10" tabindex="-1"></a>  </span>
<span id="cb151-11"><a href="#cb151-11" tabindex="-1"></a>  I <span class="ot">=</span> <span class="fu">integrate</span>(integrand, <span class="dv">0</span>, ck)</span>
<span id="cb151-12"><a href="#cb151-12" tabindex="-1"></a>  </span>
<span id="cb151-13"><a href="#cb151-13" tabindex="-1"></a>  b<span class="sc">*</span>I<span class="sc">$</span>value</span>
<span id="cb151-14"><a href="#cb151-14" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" tabindex="-1"></a>K <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">4</span><span class="sc">:</span><span class="dv">25</span>, <span class="dv">100</span>, <span class="dv">500</span>, <span class="dv">1000</span>)</span>
<span id="cb152-2"><a href="#cb152-2" tabindex="-1"></a>ans <span class="ot">=</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(K))</span>
<span id="cb152-3"><a href="#cb152-3" tabindex="-1"></a>eps <span class="ot">&lt;-</span> .Machine<span class="sc">$</span>double.eps<span class="sc">^</span>{<span class="fl">0.25</span>}</span>
<span id="cb152-4"><a href="#cb152-4" tabindex="-1"></a></span>
<span id="cb152-5"><a href="#cb152-5" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(K)){</span>
<span id="cb152-6"><a href="#cb152-6" tabindex="-1"></a>  k <span class="ot">=</span> K[i]</span>
<span id="cb152-7"><a href="#cb152-7" tabindex="-1"></a>  ans[i] <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(<span class="cf">function</span>(a){</span>
<span id="cb152-8"><a href="#cb152-8" tabindex="-1"></a>    <span class="fu">f</span>(k <span class="sc">-</span> <span class="dv">1</span>, a) <span class="sc">-</span> <span class="fu">f</span>(k, a)</span>
<span id="cb152-9"><a href="#cb152-9" tabindex="-1"></a>  }, <span class="at">interval =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">1.9</span>))<span class="sc">$</span>root</span>
<span id="cb152-10"><a href="#cb152-10" tabindex="-1"></a>  </span>
<span id="cb152-11"><a href="#cb152-11" tabindex="-1"></a>}</span>
<span id="cb152-12"><a href="#cb152-12" tabindex="-1"></a></span>
<span id="cb152-13"><a href="#cb152-13" tabindex="-1"></a>data <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">k =</span> K, <span class="at">a =</span> ans)</span>
<span id="cb152-14"><a href="#cb152-14" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(data, <span class="at">align =</span> <span class="fu">c</span>(<span class="st">&quot;c&quot;</span>, <span class="st">&quot;c&quot;</span>))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="center">k</th>
<th align="center">a</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">4</td>
<td align="center">1.492098</td>
</tr>
<tr class="even">
<td align="center">5</td>
<td align="center">1.533551</td>
</tr>
<tr class="odd">
<td align="center">6</td>
<td align="center">1.562745</td>
</tr>
<tr class="even">
<td align="center">7</td>
<td align="center">1.584438</td>
</tr>
<tr class="odd">
<td align="center">8</td>
<td align="center">1.601155</td>
</tr>
<tr class="even">
<td align="center">9</td>
<td align="center">1.614517</td>
</tr>
<tr class="odd">
<td align="center">10</td>
<td align="center">1.625383</td>
</tr>
<tr class="even">
<td align="center">11</td>
<td align="center">1.634409</td>
</tr>
<tr class="odd">
<td align="center">12</td>
<td align="center">1.642026</td>
</tr>
<tr class="even">
<td align="center">13</td>
<td align="center">1.648540</td>
</tr>
<tr class="odd">
<td align="center">14</td>
<td align="center">1.654175</td>
</tr>
<tr class="even">
<td align="center">15</td>
<td align="center">1.659097</td>
</tr>
<tr class="odd">
<td align="center">16</td>
<td align="center">1.663434</td>
</tr>
<tr class="even">
<td align="center">17</td>
<td align="center">1.667284</td>
</tr>
<tr class="odd">
<td align="center">18</td>
<td align="center">1.670725</td>
</tr>
<tr class="even">
<td align="center">19</td>
<td align="center">1.673818</td>
</tr>
<tr class="odd">
<td align="center">20</td>
<td align="center">1.676615</td>
</tr>
<tr class="even">
<td align="center">21</td>
<td align="center">1.679155</td>
</tr>
<tr class="odd">
<td align="center">22</td>
<td align="center">1.681472</td>
</tr>
<tr class="even">
<td align="center">23</td>
<td align="center">1.683595</td>
</tr>
<tr class="odd">
<td align="center">24</td>
<td align="center">1.685547</td>
</tr>
<tr class="even">
<td align="center">25</td>
<td align="center">1.687348</td>
</tr>
<tr class="odd">
<td align="center">100</td>
<td align="center">1.720601</td>
</tr>
<tr class="even">
<td align="center">500</td>
<td align="center">1.729747</td>
</tr>
<tr class="odd">
<td align="center">1000</td>
<td align="center">1.730898</td>
</tr>
</tbody>
</table>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
